{"remainingRequest":"D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\babel-loader\\lib\\index.js!D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\project\\softwareDevelopment\\IM-Web\\src\\components\\friend\\friend-list.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\project\\softwareDevelopment\\IM-Web\\src\\components\\friend\\friend-list.vue","mtime":1649851412187},{"path":"D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1649851454799},{"path":"D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\babel-loader\\lib\\index.js","mtime":1649851455045},{"path":"D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1649851454799},{"path":"D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\vue-loader\\lib\\index.js","mtime":1649851455309},{"path":"D:\\project\\softwareDevelopment\\IM-Web\\babel.config.js","mtime":1649851550121},{"path":"D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1649851454799},{"path":"D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\babel-loader\\lib\\index.js","mtime":1649851455045},{"path":"D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1649851454799},{"path":"D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\vue-loader\\lib\\index.js","mtime":1649851455309}],"contextDependencies":[],"result":["import \"core-js/modules/es7.object.get-own-property-descriptors\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.object.keys\";\nimport \"core-js/modules/es6.function.name\";\nimport _defineProperty from \"D:/project/softwareDevelopment/IM-Web/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { mapState } from 'vuex';\nimport FriendItem from \"./friend-item.vue\";\nimport FriendApplication from \"./friend-application/application-item.vue\";\nexport default {\n  components: {\n    FriendItem: FriendItem,\n    FriendApplication: FriendApplication\n  },\n  data: function data() {\n    return {\n      active: {},\n      hideTimeOut: 1000,\n      openeds: ['friendList'],\n      showDialog: false,\n      searchShow: false,\n      dialogAddFriendVisible: false,\n      dialogRenameGroup: false,\n      dialogAddGroup: false,\n      userID: '',\n      groupName: '',\n      newGroupName: '',\n      oldGroupName: '',\n      addForm: {\n        userID: '',\n        remark: '',\n        groupName: '',\n        wording: '',\n        type: this.TIM.TYPES.SNS_ADD_TYPE_BOTH\n      },\n      addInfo: {\n        groupName: '',\n        userList: ''\n      },\n      profile: {\n        avatar: '',\n        nick: '',\n        userID: ''\n      },\n      formLabelWidth: '120px'\n    };\n  },\n  computed: _objectSpread(_objectSpread({}, mapState({\n    friendList: function friendList(state) {\n      return state.friend.friendList;\n    },\n    applicationList: function applicationList(state) {\n      return state.friend.applicationList;\n    },\n    applicationUnreadCount: function applicationUnreadCount(state) {\n      return state.friend.unreadCount;\n    },\n    myProfile: function myProfile(state) {\n      return state.user.currentUserProfile;\n    },\n    friendGroupList: function friendGroupList(state) {\n      return state.friend.friendGroupList;\n    }\n  })), {}, {\n    hasFriend: function hasFriend() {\n      return this.friendList.length > 0;\n    },\n    friendGroupNameList: function friendGroupNameList() {\n      return this.friendGroupList.map(function (item) {\n        return item.name;\n      });\n    },\n    comeInApplicationList: function comeInApplicationList() {\n      var _this = this;\n\n      return this.applicationList.filter(function (item) {\n        return item.type === _this.TIM.TYPES.SNS_APPLICATION_SENT_TO_ME;\n      });\n    },\n    groupFriend: function groupFriend() {\n      return function (userIDList) {\n        if (userIDList.length === 0) {\n          return;\n        }\n\n        return this.friendList.filter(function (item) {\n          return userIDList.indexOf(item.userID) > -1;\n        });\n      };\n    }\n  }),\n  mounted: function mounted() {\n    this.$set(this.active, 'friendList', true);\n  },\n  methods: {\n    handleOpen: function handleOpen(key, keyPath) {\n      var _this2 = this;\n\n      if (keyPath.length === 1) {\n        this.$set(this.active, keyPath[0], true);\n      } else {\n        this.$set(this.active, keyPath[1], true);\n      }\n\n      if (key === 'application' && this.applicationUnreadCount > 0) {\n        this.tim.setFriendApplicationRead().then(function () {\n          _this2.$store.commit('updateUnreadCount', 0); // 已读上报成功\n\n        }).catch(function (imError) {\n          console.warn('setFriendApplicationRead error:', imError);\n        });\n      }\n    },\n    handleClose: function handleClose(key, keyPath) {\n      if (keyPath.length === 1) {\n        this.$set(this.active, keyPath[0], false);\n      } else {\n        this.$set(this.active, keyPath[1], false);\n      }\n    },\n    handleAddButtonClick: function handleAddButtonClick() {\n      this.showDialog = true;\n    },\n    addFriendPopClick: function addFriendPopClick() {\n      this.showDialog = false;\n      this.dialogAddFriendVisible = true; // this.addForm.wording = `我是${this.myProfile.nick || this.myProfile.userID} ...`\n    },\n    addFriendConfirm: function addFriendConfirm() {\n      var _this3 = this;\n\n      this.tim.getUserProfile({\n        userIDList: [this.userID]\n      }).then(function (imResponse) {\n        _this3.searchShow = true;\n        var profile = imResponse.data[0];\n        _this3.addForm.userID = profile.userID;\n        _this3.profile.avatar = profile.avatar;\n        _this3.profile.userID = profile.userID;\n        _this3.profile.nick = profile.nick;\n      }).catch(function (imError) {\n        console.warn('getUserProfile error:', imError); // 获取其他用户资料失败的相关信息\n\n        _this3.searchShow = false;\n\n        _this3.$store.commit('showMessage', {\n          message: '没有找到该用户',\n          type: 'warning'\n        });\n      });\n      this.userID = '';\n    },\n    addFriend: function addFriend() {\n      var _this4 = this;\n\n      this.dialogAddFriendVisible = false;\n      this.tim.addFriend({\n        to: this.addForm.userID,\n        remark: this.addForm.remark,\n        groupName: this.addForm.groupName,\n        wording: this.addForm.wording,\n        source: 'AddSource_Type_Web',\n        type: this.addForm.type\n      }).then(function (res) {\n        if (res.data.code === 0) {\n          _this4.$store.commit('showMessage', {\n            message: '添加成功',\n            type: 'success'\n          });\n        }\n\n        if (res.data.code === 30539) {\n          _this4.$store.commit('showMessage', {\n            message: res.data.message,\n            type: 'warning'\n          });\n        }\n      }).catch(function (error) {\n        _this4.$store.commit('showMessage', {\n          message: error.message,\n          type: 'warning'\n        });\n      });\n      this.searchShow = false;\n      this.profile = {\n        avatar: '',\n        nick: '',\n        userID: ''\n      };\n      this.addForm = {\n        userID: '',\n        remark: '',\n        groupName: '',\n        wording: ''\n      };\n    },\n    addGroupConfirm: function addGroupConfirm() {\n      var _this5 = this;\n\n      this.tim.createFriendGroup({\n        name: this.groupName\n      }).then(function () {}).catch(function (error) {\n        _this5.$store.commit('showMessage', {\n          type: 'error',\n          message: error.message\n        });\n      });\n      this.groupName = '';\n      this.dialogAddGroup = false;\n    },\n    deleteFriendGroup: function deleteFriendGroup(name) {\n      var _this6 = this;\n\n      this.tim.deleteFriendGroup({\n        name: name\n      }).then(function () {\n        _this6.$store.commit('showMessage', {\n          message: '删除成功',\n          type: 'success'\n        });\n      }).catch(function (error) {\n        _this6.$store.commit('showMessage', {\n          message: error.message,\n          type: 'warning'\n        });\n      });\n    },\n    renameFriendGroupHandler: function renameFriendGroupHandler(name) {\n      this.dialogRenameGroup = true;\n      this.oldGroupName = name;\n      this.newGroupName = name;\n    },\n    renameGroupConfirm: function renameGroupConfirm() {\n      var _this7 = this;\n\n      this.tim.renameFriendGroup({\n        oldName: this.oldGroupName,\n        newName: this.newGroupName\n      }).then(function () {\n        _this7.$store.commit('showMessage', {\n          message: '修改成功',\n          type: 'success'\n        });\n      }).catch(function (error) {\n        _this7.$store.commit('showMessage', {\n          message: error.message,\n          type: 'warning'\n        });\n      });\n      this.dialogRenameGroup = false;\n    }\n  }\n};",{"version":3,"mappings":"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","names":["components","FriendItem","FriendApplication","data","active","hideTimeOut","openeds","showDialog","searchShow","dialogAddFriendVisible","dialogRenameGroup","dialogAddGroup","userID","groupName","newGroupName","oldGroupName","addForm","remark","wording","type","addInfo","userList","profile","avatar","nick","formLabelWidth","computed","mapState","friendList","applicationList","applicationUnreadCount","myProfile","friendGroupList","hasFriend","friendGroupNameList","comeInApplicationList","groupFriend","mounted","methods","handleOpen","key","keyPath","catch","console","handleClose","handleAddButtonClick","addFriendPopClick","addFriendConfirm","userIDList","then","message","addFriend","to","source","addGroupConfirm","name","deleteFriendGroup","renameFriendGroupHandler","renameGroupConfirm","oldName","newName"],"sourceRoot":"src/components/friend","sources":["friend-list.vue"],"sourcesContent":["<template>\r\n  <div class=\"friend-container\">\r\n    <div class=\"add-friend\" @click=\"handleAddButtonClick\">\r\n      <i class=\"tim-icon-friend-add\" style=\"font-size: 28px\"></i>\r\n      <span style=\"margin-left: 6px\">加好友</span>\r\n    </div>\r\n    <el-dialog title=\"快速搜索好友\" :visible.sync=\"showDialog\" width=\"400px\">\r\n      <el-input placeholder=\"请输入用户ID\" v-model=\"userID\" @keydown.enter.native=\"addFriendConfirm\">\r\n        <el-button slot=\"append\" icon=\"el-icon-search\" @click=\"addFriendConfirm\"></el-button>\r\n        </el-input>\r\n      <el-divider></el-divider>\r\n      <div class=\"search-item\" v-if=\"searchShow\">\r\n        <avatar :src=\"profile.avatar\" />\r\n        <div   class=\"item-nick\">{{profile.nick||profile.userID}}</div>\r\n        <img  class=\"add-friend-icon\" src=\"../../assets/image/add-friend.png\" @click=\"addFriendPopClick\"/>\r\n      </div>\r\n    </el-dialog>\r\n<!--    添加好友-->\r\n    <el-dialog title=\"添加好友\" :visible.sync=\"dialogAddFriendVisible\" width=\"600px\">\r\n        <el-form :model=\"addForm\">\r\n          <el-form-item label=\"\" :label-width=\"formLabelWidth\">\r\n            <div class=\"search-item\">\r\n              <avatar :src=\"profile.avatar\" />\r\n              <div  class=\"item-nick\">{{profile.nick||profile.userID}}</div>\r\n            </div>\r\n          </el-form-item>\r\n          <el-form-item label=\"请输入验证信息\" :label-width=\"formLabelWidth\">\r\n            <el-input\r\n                    type=\"textarea\"\r\n                    :rows=\"2\"\r\n                    placeholder=\"请输入验证信息\"\r\n                    v-model=\"addForm.wording\">\r\n            </el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"分组\" :label-width=\"formLabelWidth\">\r\n            <el-select v-model=\"addForm.groupName\" placeholder=\"\">\r\n              <el-option label=\"选择分组\" value=\"\"></el-option>\r\n              <el-option  v-for=\"name in friendGroupNameList\" :key=\"name\" :label=\"name\" :value=\"name\"></el-option>\r\n            </el-select>\r\n          </el-form-item>\r\n          <el-form-item label=\"备注\" :label-width=\"formLabelWidth\">\r\n            <el-input v-model=\"addForm.remark\" autocomplete=\"off\"></el-input>\r\n          </el-form-item>\r\n        </el-form>\r\n        <div slot=\"footer\" class=\"dialog-footer\">\r\n          <el-button @click=\"dialogAddFriendVisible = false\">取 消</el-button>\r\n          <el-button type=\"primary\" @click=\"addFriend\">确 定</el-button>\r\n        </div>\r\n      </el-dialog>\r\n    <el-dialog title=\"新增好友分组\" :visible.sync=\"dialogAddGroup\" width=\"400px\">\r\n      <el-input placeholder=\"请输入分组名称\" v-model=\"groupName\" @keydown.enter.native=\"addGroupConfirm\"/>\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"dialogAddGroup = false\">取 消</el-button>\r\n        <el-button type=\"primary\" @click=\"addGroupConfirm\">确 定</el-button>\r\n      </span>\r\n    </el-dialog>\r\n    <el-dialog title=\"请输入分组名称\" :visible.sync=\"dialogRenameGroup\" width=\"400px\">\r\n      <el-input  v-model=\"newGroupName\" @keydown.enter.native=\"renameGroupConfirm\"/>\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"dialogRenameGroup = false\">取 消</el-button>\r\n        <el-button type=\"primary\" @click=\"renameGroupConfirm\">确 定</el-button>\r\n      </span>\r\n    </el-dialog>\r\n    <div class=\"scroll-container\">\r\n      <div class=\"menu-container\">\r\n        <el-menu\r\n                default-active=\"application\"\r\n                class=\"el-menu-vertical-demo\"\r\n                :default-openeds=\"openeds\"\r\n                @open=\"handleOpen\"\r\n                @close=\"handleClose\">\r\n          <el-submenu index=\"application\" style=\"border-buttom:1px solid #1c2438\">\r\n            <template slot=\"title\">\r\n              <i :class=\"{'el-icon-arrow-right': !active['application'], 'el-icon-arrow-down': active['application']}\"></i>\r\n              <span>新的好友\r\n                <sup class=\"unread\" v-if=\"applicationUnreadCount !== 0\">\r\n                  <template v-if=\"applicationUnreadCount > 99\">99+</template>\r\n                  <template v-else>{{applicationUnreadCount}}</template>\r\n                </sup>\r\n            </span>\r\n            </template>\r\n            <el-menu-item-group>\r\n              <el-menu-item :index=\"application.userID\" v-for=\"(application, index) in comeInApplicationList\" :key=\"application.userID\">\r\n                <friend-application  :application=\"application\" :index=\"index\"></friend-application>\r\n              </el-menu-item>\r\n            </el-menu-item-group>\r\n          </el-submenu>\r\n          <el-submenu index=\"friendGroup\">\r\n            <template slot=\"title\">\r\n              <i :class=\"{'el-icon-arrow-right': !active['friendGroup'], 'el-icon-arrow-down': active['friendGroup']}\"></i>\r\n              <span>好友分组</span>\r\n              <i class=\"el-icon-circle-plus-outline friend-group-btn\" style=\"right: 20px;font-size: 20px\" @click.stop=\"dialogAddGroup=true\"></i>\r\n            </template>\r\n            <el-menu-item-group>\r\n              <el-submenu :index=\"friendGroup.name\" v-for=\"friendGroup in friendGroupList\" :key=\"friendGroup.name\">\r\n                <template slot=\"title\">\r\n                  <i :class=\"{'el-icon-arrow-right': !active[friendGroup.name], 'el-icon-arrow-down': active[friendGroup.name]}\" v-show=\"friendGroup.userIDList.length>0\" class=\"animated\"></i>\r\n                  <i style=\"padding-left: 15px\" v-show=\"friendGroup.userIDList.length===0\"></i>\r\n                  <span>{{friendGroup.name}}</span>\r\n                  <span @click.stop>\r\n                  <el-popover\r\n                          placement=\"bottom-start\"\r\n                          width=\"200\"\r\n                          trigger=\"click\"\r\n                  >\r\n\r\n                    <p @click=\"renameFriendGroupHandler(friendGroup.name)\">重命名该组</p>\r\n                    <p @click=\"deleteFriendGroup(friendGroup.name)\">删除该组</p>\r\n                     <img src=\"../../assets/image/more-icon.png\" class=\"friend-group-btn more-icon\" slot=\"reference\">\r\n                  </el-popover>\r\n                </span>\r\n                </template>\r\n                <el-menu-item index=\"1-4-1\" v-for=\"(friend,index) in groupFriend(friendGroup.userIDList)\" :key=\"friend.userID\" >\r\n                  <friend-item  :friend=\"friend\" :friendGroupNameList=\"friendGroupNameList\"  :index=\"index\" :type=\"'groupFriend'\" :groupName=\"friendGroup.name\">\r\n                  </friend-item>\r\n                </el-menu-item>\r\n              </el-submenu>\r\n            </el-menu-item-group>\r\n          </el-submenu>\r\n          <el-submenu :hide-timeout=\"hideTimeOut\"  index=\"friendList\" style=\"border-buttom:1px solid #1c2438\">\r\n            <template slot=\"title\">\r\n              <i :class=\"{'el-icon-arrow-right': !active['friendList'], 'el-icon-arrow-down': active['friendList']}\"></i>\r\n              <span>联系人</span>\r\n            </template>\r\n            <el-menu-item-group>\r\n              <el-menu-item   :index=\"friend.userID\" v-for=\"(friend,index) in friendList\"  :key=\"friend.userID\">\r\n                <friend-item  :index=\"index\" :friend=\"friend\"  :friendGroupNameList=\"friendGroupNameList\" :type=\"'friendList'\"/>\r\n              </el-menu-item>\r\n            </el-menu-item-group>\r\n          </el-submenu>\r\n        </el-menu>\r\n      </div>\r\n    </div>\r\n\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapState } from 'vuex'\r\nimport FriendItem from './friend-item.vue'\r\nimport FriendApplication from './friend-application/application-item.vue'\r\nexport default {\r\n  components: {\r\n    FriendItem,\r\n    FriendApplication\r\n  },\r\n  data() {\r\n    return {\r\n      active: {},\r\n      hideTimeOut: 1000,\r\n      openeds: ['friendList'],\r\n      showDialog: false,\r\n      searchShow: false,\r\n      dialogAddFriendVisible: false,\r\n      dialogRenameGroup: false,\r\n      dialogAddGroup: false,\r\n      userID: '',\r\n      groupName: '',\r\n      newGroupName: '',\r\n      oldGroupName: '',\r\n      addForm: {\r\n        userID: '',\r\n        remark: '',\r\n        groupName: '',\r\n        wording: '',\r\n        type: this.TIM.TYPES.SNS_ADD_TYPE_BOTH\r\n      },\r\n      addInfo: {\r\n        groupName: '',\r\n        userList: ''\r\n      },\r\n      profile: {\r\n        avatar: '',\r\n        nick: '',\r\n        userID: '',\r\n      },\r\n      formLabelWidth: '120px'\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapState({\r\n      friendList: state => state.friend.friendList,\r\n      applicationList: state => state.friend.applicationList,\r\n      applicationUnreadCount: state => state.friend.unreadCount,\r\n      myProfile: state => state.user.currentUserProfile,\r\n      friendGroupList: state => state.friend.friendGroupList,\r\n    }),\r\n    hasFriend() {\r\n      return this.friendList.length > 0\r\n    },\r\n    friendGroupNameList() {\r\n      return this.friendGroupList.map((item) => {return item.name})\r\n    },\r\n    comeInApplicationList() {\r\n      return this.applicationList.filter((item) => {return item.type === this.TIM.TYPES.SNS_APPLICATION_SENT_TO_ME})\r\n    },\r\n    groupFriend() {\r\n      return function (userIDList) {\r\n        if (userIDList.length === 0) {\r\n          return\r\n        }\r\n        return this.friendList.filter((item) => userIDList.indexOf(item.userID) > -1)\r\n      }\r\n    },\r\n  },\r\n  mounted() {\r\n    this.$set(this.active, 'friendList',  true)\r\n  },\r\n  methods: {\r\n    handleOpen(key, keyPath) {\r\n      if(keyPath.length ===1) {\r\n        this.$set(this.active, keyPath[0], true)\r\n      }else {\r\n        this.$set(this.active, keyPath[1], true)\r\n      }\r\n      if(key === 'application' && this.applicationUnreadCount > 0) {\r\n        this.tim.setFriendApplicationRead().then(()=> {\r\n          this.$store.commit('updateUnreadCount', 0)\r\n          // 已读上报成功\r\n        }).catch((imError)=> {\r\n          console.warn('setFriendApplicationRead error:', imError)\r\n        })\r\n      }\r\n    },\r\n    handleClose(key, keyPath) {\r\n      if(keyPath.length ===1) {\r\n        this.$set(this.active, keyPath[0], false)\r\n      }else {\r\n        this.$set(this.active, keyPath[1], false)\r\n      }\r\n    },\r\n    handleAddButtonClick() {\r\n      this.showDialog = true\r\n    },\r\n    addFriendPopClick() {\r\n      this.showDialog = false\r\n      this.dialogAddFriendVisible = true\r\n      // this.addForm.wording = `我是${this.myProfile.nick || this.myProfile.userID} ...`\r\n    },\r\n    addFriendConfirm() {\r\n      this.tim.getUserProfile({\r\n        userIDList: [this.userID]\r\n      }).then((imResponse) => {\r\n        this.searchShow = true\r\n        const profile = imResponse.data[0]\r\n        this.addForm.userID  = profile.userID\r\n        this.profile.avatar = profile.avatar\r\n        this.profile.userID = profile.userID\r\n        this.profile.nick = profile.nick\r\n      }).catch((imError)=> {\r\n        console.warn('getUserProfile error:', imError) // 获取其他用户资料失败的相关信息\r\n        this.searchShow = false\r\n        this.$store.commit('showMessage', {\r\n          message: '没有找到该用户',\r\n          type: 'warning'\r\n        })\r\n      })\r\n      this.userID = ''\r\n    },\r\n    addFriend() {\r\n      this.dialogAddFriendVisible = false\r\n      this.tim.addFriend({\r\n        to: this.addForm.userID,\r\n        remark: this.addForm.remark,\r\n        groupName: this.addForm.groupName,\r\n        wording: this.addForm.wording,\r\n        source: 'AddSource_Type_Web',\r\n        type: this.addForm.type\r\n      }).then((res) => {\r\n        if (res.data.code === 0) {\r\n          this.$store.commit('showMessage', {\r\n            message: '添加成功',\r\n            type: 'success'\r\n          })\r\n        }\r\n        if (res.data.code === 30539) {\r\n          this.$store.commit('showMessage', {\r\n            message: res.data.message,\r\n            type: 'warning'\r\n          })\r\n        }\r\n      }).catch(error => {\r\n        this.$store.commit('showMessage', {\r\n          message: error.message,\r\n          type: 'warning'\r\n        })\r\n      })\r\n      this.searchShow = false\r\n      this.profile =  {\r\n        avatar: '',\r\n        nick: '',\r\n        userID: '',\r\n      }\r\n      this.addForm = {\r\n        userID: '',\r\n        remark: '',\r\n        groupName: '',\r\n        wording: '',\r\n      }\r\n    },\r\n    addGroupConfirm() {\r\n      this.tim.createFriendGroup({\r\n        name: this.groupName\r\n      }).then(() => {\r\n      }).catch((error) => {\r\n        this.$store.commit('showMessage', {\r\n          type: 'error',\r\n          message: error.message\r\n        })\r\n      })\r\n      this.groupName = ''\r\n      this.dialogAddGroup = false\r\n    },\r\n    deleteFriendGroup(name) {\r\n      this.tim.deleteFriendGroup({\r\n        name: name\r\n      }).then(() => {\r\n        this.$store.commit('showMessage', {\r\n          message: '删除成功',\r\n          type: 'success'\r\n        })\r\n      }).catch((error) => {\r\n        this.$store.commit('showMessage', {\r\n          message: error.message,\r\n          type: 'warning'\r\n        })\r\n      })\r\n    },\r\n    renameFriendGroupHandler(name) {\r\n      this.dialogRenameGroup = true\r\n      this.oldGroupName = name\r\n      this.newGroupName = name\r\n    },\r\n    renameGroupConfirm() {\r\n      this.tim.renameFriendGroup({\r\n        oldName: this.oldGroupName,\r\n        newName: this.newGroupName\r\n      }).then(() => {\r\n        this.$store.commit('showMessage', {\r\n          message: '修改成功',\r\n          type: 'success'\r\n        })\r\n      }).catch((error) => {\r\n        this.$store.commit('showMessage', {\r\n          message: error.message,\r\n          type: 'warning'\r\n        })\r\n      })\r\n      this.dialogRenameGroup = false\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style lang=\"stylus\" scpoed>\r\n.friend-container {\r\n    height 100%\r\n    width 100%\r\n    display flex\r\n    flex-direction column // -reverse\r\n  .add-friend {\r\n    width 100%\r\n    cursor pointer\r\n    color #dddddd\r\n    font-size 18px\r\n    margin 20px auto 0px\r\n    text-align center\r\n    height 40px\r\n    border-bottom 1px solid #1c2438\r\n  }\r\n  .scroll-container  {\r\n    overflow-y scroll\r\n    flex 1\r\n    .menu-container {\r\n      .unread {\r\n        position: absolute;\r\n        top: 10px;\r\n        margin-left 2px\r\n        z-index: 999;\r\n        display: inline-block;\r\n        height: 18px;\r\n        padding: 0 6px;\r\n        font-size: 12px;\r\n        color: #FFF;\r\n        line-height: 18px;\r\n        text-align: center;\r\n        white-space: nowrap;\r\n        border-radius: 10px;\r\n        background-color: $danger;\r\n      }\r\n      .friend-group-btn {\r\n        position absolute\r\n        top 20px\r\n        right 15px\r\n        bottom 0\r\n        margin auto\r\n      }\r\n      .more-icon {\r\n        display block\r\n        width 36px\r\n        top: -3px\r\n      }\r\n      .el-submenu__title, .el-menu-item {\r\n        font-size 16px\r\n        color #ffffff\r\n      }\r\n      .el-menu-item {\r\n        padding-left 20px !important\r\n        padding-right 10px\r\n        height 58px\r\n        line-height 58px\r\n      }\r\n      .el-menu-item * {\r\n        vertical-align: baseline\r\n        }\r\n      .el-submenu {\r\n        font-size 20px\r\n      }\r\n      .el-submenu .el-submenu__title {\r\n        /*padding-left 0 !important*/\r\n      }\r\n      .el-menu-item:focus, .el-menu-item:hover {\r\n        background-color #404953\r\n      }\r\n      .el-submenu__title:focus, .el-submenu__title:hover {\r\n        background-color #404953\r\n      }\r\n      .el-menu-item {\r\n        padding-left 10px !important\r\n      }\r\n      .el-menu {\r\n        background-color transparent\r\n        border-right none\r\n      }\r\n      .el-menu-vertical-demo {\r\n        background-color transparent\r\n      }\r\n      .el-submenu__icon-arrow {\r\n        display none\r\n      }\r\n    }\r\n    .friend-list-container {\r\n      border-top 1px solid #1c2438\r\n      padding-top 10px\r\n      padding-left -15px\r\n    }\r\n  }\r\n  .default {\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    height: 100%;\r\n    overflow-y: scroll;\r\n  }\r\n  .search-item {\r\n    display flex\r\n    .avatar {\r\n      width: 40px;\r\n      height: 40px;\r\n      border-radius: 50%;\r\n      flex-shrink: 0\r\n      box-shadow: 0 5px 10px 0 rgba(0, 0, 0, 0.1);\r\n    }\r\n    .item-nick {\r\n      margin-left 20px\r\n      line-height 48px\r\n    }\r\n\r\n  }\r\n\r\n  .el-icon-circle-plus-outline:before {\r\n    color #ffffff\r\n  }\r\n  .add-friend-icon {\r\n    cursor pointer\r\n    width 30px\r\n    height 30px\r\n    display block\r\n    position absolute\r\n    right 40px\r\n    bottom 40px\r\n  }\r\n  .el-icon-arrow-right {\r\n    transition: all .2s ease;\r\n  }\r\n}\r\n\r\n\r\n</style>\r\n"]}]}