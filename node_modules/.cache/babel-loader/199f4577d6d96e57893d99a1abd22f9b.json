{"remainingRequest":"D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\babel-loader\\lib\\index.js!D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\project\\softwareDevelopment\\IM-Web\\src\\components\\group-live\\components\\live-header.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\project\\softwareDevelopment\\IM-Web\\src\\components\\group-live\\components\\live-header.vue","mtime":1649851412188},{"path":"D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1649851454799},{"path":"D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\babel-loader\\lib\\index.js","mtime":1649851455045},{"path":"D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1649851454799},{"path":"D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\vue-loader\\lib\\index.js","mtime":1649851455309},{"path":"D:\\project\\softwareDevelopment\\IM-Web\\babel.config.js","mtime":1649851550121},{"path":"D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1649851454799},{"path":"D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\babel-loader\\lib\\index.js","mtime":1649851455045},{"path":"D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1649851454799},{"path":"D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\vue-loader\\lib\\index.js","mtime":1649851455309}],"contextDependencies":[],"result":["import \"core-js/modules/es7.object.get-own-property-descriptors\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.object.keys\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"D:/project/softwareDevelopment/IM-Web/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _defineProperty from \"D:/project/softwareDevelopment/IM-Web/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { mapState } from 'vuex';\nexport default {\n  name: 'liveHeader',\n  props: {\n    fr: {\n      type: String,\n      requred: true\n    },\n    isPushingStream: {\n      type: Boolean,\n      default: false\n    },\n    stopPushStream: {\n      type: Function\n    },\n    pusherTime: {\n      type: String,\n      default: ''\n    }\n  },\n  data: function data() {\n    return {\n      nick: '',\n      avatar: 'https://imgcache.qq.com/open/qcloud/video/act/webim-avatar/avatar-2.png',\n      onlineMemberCount: 0,\n      timer: null,\n      onlineList: []\n    };\n  },\n  computed: _objectSpread(_objectSpread({}, mapState({\n    groupLiveInfo: function groupLiveInfo(state) {\n      return state.groupLive.groupLiveInfo;\n    }\n  })), {}, {\n    showLiveInfo: function showLiveInfo() {\n      return this.fr === 'pusher' && this.isPushingStream || this.fr === 'player';\n    },\n    roomName: function roomName() {\n      return this.groupLiveInfo.roomName || \"\".concat(this.groupLiveInfo.anchorID, \"\\u7684\\u76F4\\u64AD\");\n    }\n  }),\n  mounted: function mounted() {\n    var _this = this;\n\n    this.getAnchorProfile();\n\n    if (this.fr === 'player') {\n      this.timer = setInterval(function () {\n        _this.getGroupOnlineMemberCount();\n      }, 5000);\n    }\n  },\n  beforeDestroy: function beforeDestroy() {\n    this.timer && clearInterval(this.timer);\n  },\n  methods: {\n    closeLiveMask: function closeLiveMask() {\n      if (this.fr === 'pusher') {\n        this.stopPushStream();\n        return;\n      }\n\n      this.$store.commit('updateGroupLiveInfo', {\n        isNeededQuitRoom: 1\n      });\n      this.$bus.$emit('close-group-live');\n    },\n    getAnchorProfile: function () {\n      var _getAnchorProfile = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n        var res;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return this.tim.getUserProfile({\n                  userIDList: [this.groupLiveInfo.anchorID]\n                });\n\n              case 2:\n                res = _context.sent;\n\n                if (res.code === 0) {\n                  this.nick = res.data[0].nick || res.data[0].userID;\n                  this.avatar = res.data[0].avatar || 'https://imgcache.qq.com/open/qcloud/video/act/webim-avatar/avatar-2.png';\n                }\n\n              case 4:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function getAnchorProfile() {\n        return _getAnchorProfile.apply(this, arguments);\n      }\n\n      return getAnchorProfile;\n    }(),\n    getGroupOnlineMemberCount: function () {\n      var _getGroupOnlineMemberCount = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {\n        var res;\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return this.tim.getGroupOnlineMemberCount(this.groupLiveInfo.roomID);\n\n              case 2:\n                res = _context2.sent;\n\n                if (res.code === 0 && res.data) {\n                  this.onlineMemberCount = res.data.memberCount;\n                }\n\n              case 4:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function getGroupOnlineMemberCount() {\n        return _getGroupOnlineMemberCount.apply(this, arguments);\n      }\n\n      return getGroupOnlineMemberCount;\n    }()\n  },\n  watch: {\n    isPushingStream: function isPushingStream(val) {\n      var _this2 = this;\n\n      if (val && this.fr === 'pusher') {\n        this.timer = setInterval(function () {\n          _this2.getGroupOnlineMemberCount();\n        }, 5000);\n      }\n    }\n  }\n};",{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuBA;AACA;AACAA,oBADA;AAEAC;AACAC;AACAC,kBADA;AAEAC;AAFA,KADA;AAKAC;AACAF,mBADA;AAEAG;AAFA,KALA;AASAC;AACAJ;AADA,KATA;AAYAK;AACAL,kBADA;AAEAG;AAFA;AAZA,GAFA;AAmBAG,MAnBA,kBAmBA;AACA;AACAC,cADA;AAEAC,uFAFA;AAGAC,0BAHA;AAIAC,iBAJA;AAKAC;AALA;AAOA,GA3BA;AA4BAC,4CACAC;AACAC;AAAA;AAAA;AADA,IADA;AAIAC,gBAJA,0BAIA;AACA;AACA,KANA;AAOAC,YAPA,sBAOA;AACA;AACA;AATA,IA5BA;AAuCAC,SAvCA,qBAuCA;AAAA;;AACA;;AACA;AACA;AACA;AACA,OAFA,EAEA,IAFA;AAGA;AACA,GA9CA;AA+CAC,eA/CA,2BA+CA;AACA;AACA,GAjDA;AAkDAC;AACAC,iBADA,2BACA;AACA;AACA;AACA;AACA;;AACA;AAAAC;AAAA;AACA;AACA,KARA;AASAC,oBATA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAUA;AAAAC;AAAA,kBAVA;;AAAA;AAUAC,mBAVA;;AAWA;AACA;AACA;AACA;;AAdA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAgBAC,6BAhBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAiBA,6DAjBA;;AAAA;AAiBAD,mBAjBA;;AAkBA;AACA;AACA;;AApBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA,GAlDA;AAyEAE;AACAxB;AAAA;;AACA;AACA;AACA;AACA,SAFA,EAEA,IAFA;AAGA;AACA;AAPA;AAzEA","names":["name","props","fr","type","requred","isPushingStream","default","stopPushStream","pusherTime","data","nick","avatar","onlineMemberCount","timer","onlineList","computed","mapState","groupLiveInfo","showLiveInfo","roomName","mounted","beforeDestroy","methods","closeLiveMask","isNeededQuitRoom","getAnchorProfile","userIDList","res","getGroupOnlineMemberCount","watch"],"sourceRoot":"src/components/group-live/components","sources":["live-header.vue"],"sourcesContent":["<template>\r\n  <div class=\"header-container\">\r\n    <div v-show=\"showLiveInfo\">\r\n      <div class=\"anchor-info\">\r\n        <img class=\"anchor-avatar\" :src=\"avatar\">\r\n        <div class=\"anchor-other\">\r\n          <p class=\"anchor-nick\">{{nick}}</p>\r\n          <p class=\"online-num\">在线：{{onlineMemberCount}}</p>\r\n        </div>\r\n      </div>\r\n      <div class=\"online-info\">\r\n        <p class=\"room-name\">直播中</p>\r\n        <img class=\"living-icon\" src=\"../../../assets/image/living-icon.gif\" />\r\n        <span>{{` ${pusherTime}`}}</span>\r\n      </div>\r\n    </div>\r\n    <div class=\"close-box\" @click=\"closeLiveMask\">\r\n      <i class=\"el-icon-circle-close\"></i>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n import { mapState } from 'vuex'\r\n  export default {\r\n    name: 'liveHeader',\r\n    props: {\r\n      fr: {\r\n        type: String,\r\n        requred: true\r\n      },\r\n      isPushingStream: {\r\n        type: Boolean,\r\n        default: false\r\n      },\r\n      stopPushStream: {\r\n        type: Function\r\n      },\r\n      pusherTime: {\r\n        type: String,\r\n        default: ''\r\n      }\r\n    },\r\n    data() {\r\n      return {\r\n        nick: '',\r\n        avatar: 'https://imgcache.qq.com/open/qcloud/video/act/webim-avatar/avatar-2.png',\r\n        onlineMemberCount: 0,\r\n        timer: null,\r\n        onlineList: []\r\n      }\r\n    },\r\n    computed: {\r\n      ...mapState({\r\n        groupLiveInfo: state => state.groupLive.groupLiveInfo\r\n      }),\r\n      showLiveInfo() {\r\n        return (this.fr === 'pusher' && this.isPushingStream) || this.fr === 'player'\r\n      },\r\n      roomName() {\r\n        return this.groupLiveInfo.roomName || `${this.groupLiveInfo.anchorID}的直播`\r\n      }\r\n    },\r\n    mounted() {\r\n      this.getAnchorProfile()\r\n      if (this.fr === 'player') {\r\n        this.timer = setInterval(() => {\r\n          this.getGroupOnlineMemberCount()\r\n        }, 5000)\r\n      }\r\n    },\r\n    beforeDestroy() {\r\n      this.timer && clearInterval(this.timer)\r\n    },\r\n    methods: {\r\n      closeLiveMask() {\r\n        if (this.fr === 'pusher') {\r\n          this.stopPushStream()\r\n          return\r\n        }\r\n        this.$store.commit('updateGroupLiveInfo', { isNeededQuitRoom: 1 })\r\n        this.$bus.$emit('close-group-live')\r\n      },\r\n      async getAnchorProfile() {\r\n        const res = await this.tim.getUserProfile({userIDList: [this.groupLiveInfo.anchorID]})\r\n        if (res.code === 0) {\r\n          this.nick = res.data[0].nick || res.data[0].userID\r\n          this.avatar = res.data[0].avatar || 'https://imgcache.qq.com/open/qcloud/video/act/webim-avatar/avatar-2.png'\r\n        }\r\n      },\r\n      async getGroupOnlineMemberCount() {\r\n        const res = await this.tim.getGroupOnlineMemberCount(this.groupLiveInfo.roomID)\r\n        if (res.code === 0 && res.data) {\r\n          this.onlineMemberCount = res.data.memberCount\r\n        }\r\n      }\r\n    },\r\n    watch: {\r\n      isPushingStream: function(val) {\r\n        if (val && this.fr === 'pusher') {\r\n          this.timer = setInterval(() => {\r\n            this.getGroupOnlineMemberCount()\r\n          }, 5000)\r\n        }\r\n      }\r\n    }\r\n  }\r\n</script>\r\n\r\n<style lang=\"stylus\" scoped>\r\n .header-container {\r\n   position absolute\r\n   left 0\r\n   top 0\r\n   width 100%\r\n   height 100%\r\n   box-sizing border-box\r\n   z-index 99\r\n   padding 10px 10px 10px 20px\r\n  .anchor-info {\r\n    position absolute\r\n    top 50%\r\n    transform translateY(-50%)\r\n    width 200px\r\n    height 50px\r\n    background rgba(255, 255 ,255 ,0.1)\r\n    border-radius 30px\r\n    display flex\r\n    align-items center\r\n    .anchor-avatar {\r\n      width 50px\r\n      height 50px\r\n      border-radius 50%\r\n      margin 0 5px\r\n    }\r\n    .anchor-other {\r\n      height 100%\r\n      flex 1\r\n      p {\r\n        margin 0\r\n      }\r\n      .anchor-nick{\r\n        max-width 140px\r\n        margin 6px 0 0 0\r\n        color: #ffffff\r\n        font-weight 500\r\n        word-break keep-all\r\n        overflow hidden\r\n        text-overflow ellipsis\r\n        white-space nowrap\r\n      }\r\n      .online-num{\r\n        font-size 14px\r\n        font-weight 400\r\n        color #d2cbcbad\r\n      }\r\n    }\r\n  }\r\n  .online-info {\r\n    position absolute\r\n    left 50%\r\n    top 50%\r\n    transform translate(-50%, -50%)\r\n    height 50px\r\n    color #fff\r\n    display flex\r\n    align-items center\r\n    .room-name{\r\n      display inline-block\r\n      max-width 160px\r\n      overflow hidden\r\n      white-space nowrap\r\n      text-overflow ellipsis\r\n      margin 0\r\n      padding 0 0 0 10px\r\n    }\r\n    .living-icon{\r\n      position relative\r\n      top -3px\r\n      margin 0 5px\r\n      width 25px\r\n    }\r\n    span {\r\n      margin 2px 0 0 0\r\n    }\r\n  }\r\n  .close-box {\r\n    position absolute\r\n    right 0\r\n    top 0px\r\n    width 70px\r\n    height 70px\r\n    color: #959798\r\n    font-size 36px\r\n    cursor pointer\r\n    display flex\r\n    align-items center\r\n    justify-content center\r\n  }\r\n }\r\n</style>\r\n"]}]}