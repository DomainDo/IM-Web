{"remainingRequest":"D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\babel-loader\\lib\\index.js!D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\project\\softwareDevelopment\\IM-Web\\src\\components\\conversation\\conversationProfile\\group-profile.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\project\\softwareDevelopment\\IM-Web\\src\\components\\conversation\\conversationProfile\\group-profile.vue","mtime":1649851412186},{"path":"D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1649851454799},{"path":"D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\babel-loader\\lib\\index.js","mtime":1649851455045},{"path":"D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1649851454799},{"path":"D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\vue-loader\\lib\\index.js","mtime":1649851455309},{"path":"D:\\project\\softwareDevelopment\\IM-Web\\babel.config.js","mtime":1649851550121},{"path":"D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1649851454799},{"path":"D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\babel-loader\\lib\\index.js","mtime":1649851455045},{"path":"D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1649851454799},{"path":"D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\vue-loader\\lib\\index.js","mtime":1649851455309}],"contextDependencies":[],"result":["import \"core-js/modules/es7.array.includes\";\nimport \"core-js/modules/es6.string.includes\";\nimport \"core-js/modules/es6.function.name\";\nimport _Switch2 from \"element-ui/lib/theme-chalk/switch.css\";\nimport \"element-ui/lib/theme-chalk/base.css\";\nimport _Switch from \"element-ui/lib/switch\";\nimport _Option2 from \"element-ui/lib/theme-chalk/option.css\";\nimport \"element-ui/lib/theme-chalk/base.css\";\nimport _Option from \"element-ui/lib/option\";\nimport _Select2 from \"element-ui/lib/theme-chalk/select.css\";\nimport \"element-ui/lib/theme-chalk/base.css\";\nimport _Select from \"element-ui/lib/select\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport GroupMemberList from \"./group-member-list.vue\";\nexport default {\n  props: ['groupProfile'],\n  components: {\n    GroupMemberList: GroupMemberList,\n    ElSelect: _Select,\n    ElOption: _Option,\n    ElSwitch: _Switch\n  },\n  data: function data() {\n    return {\n      showEditName: false,\n      showEditFaceUrl: false,\n      showEditIntroduction: false,\n      showEditNotification: false,\n      showEditJoinOption: false,\n      showChangeGroupOwner: false,\n      showEditMessageRemindType: false,\n      showEditNameCard: false,\n      name: this.groupProfile.name,\n      avatar: this.groupProfile.avatar,\n      introduction: this.groupProfile.introduction,\n      notification: this.groupProfile.notification,\n      joinOption: this.groupProfile.joinOption,\n      newOwnerUserID: '',\n      messageRemindType: this.groupProfile.selfInfo.messageRemindType,\n      nameCard: this.groupProfile.selfInfo.nameCard || '',\n      muteAllMembers: this.groupProfile.muteAllMembers,\n      messageRemindTypeMap: {\n        AcceptAndNotify: '接收消息并提示',\n        AcceptNotNotify: '接收消息但不提示',\n        Discard: '屏蔽消息'\n      },\n      joinOptionMap: {\n        FreeAccess: '自由加入',\n        NeedPermission: '需要验证',\n        DisableApply: '禁止加群'\n      },\n      active: false\n    };\n  },\n  computed: {\n    editable: function editable() {\n      return this.groupProfile.type === this.TIM.TYPES.GRP_WORK || [this.TIM.TYPES.GRP_MBR_ROLE_OWNER, this.TIM.TYPES.GRP_MBR_ROLE_ADMIN].includes(this.groupProfile.selfInfo.role);\n    },\n    isOwner: function isOwner() {\n      return this.groupProfile.selfInfo.role === this.TIM.TYPES.GRP_MBR_ROLE_OWNER;\n    },\n    isAdmin: function isAdmin() {\n      return this.groupProfile.selfInfo.role === this.TIM.TYPES.GRP_MBR_ROLE_ADMIN;\n    },\n    showDissmissGroup: function showDissmissGroup() {\n      // 好友工作群不能解散\n      return this.isOwner && this.groupProfile.type !== this.TIM.TYPES.GRP_WORK;\n    },\n    groupType: function groupType() {\n      switch (this.groupProfile.type) {\n        case this.TIM.TYPES.GRP_WORK:\n          return '好友工作群（Work）';\n\n        case this.TIM.TYPES.GRP_PUBLIC:\n          return '陌生人社交群（Public）';\n\n        case this.TIM.TYPES.GRP_CHATROOM:\n          return '临时会议群（Meeting）';\n\n        case this.TIM.TYPES.GRP_AVCHATROOM:\n          return '直播群（AVChatRoom）';\n\n        default:\n          return '';\n      }\n    }\n  },\n  watch: {\n    groupProfile: function groupProfile(_groupProfile) {\n      Object.assign(this, {\n        showEditName: false,\n        showEditFaceUrl: false,\n        showEditIntroduction: false,\n        showEditNotification: false,\n        showEditJoinOption: false,\n        showChangeGroupOwner: false,\n        showEditNameCard: false,\n        name: _groupProfile.name,\n        avatar: _groupProfile.avatar,\n        introduction: _groupProfile.introduction,\n        notification: _groupProfile.notification,\n        joinOption: _groupProfile.joinOption,\n        messageRemindType: _groupProfile.messageRemindType,\n        nameCard: _groupProfile.selfInfo.nameCard || '',\n        muteAllMembers: _groupProfile.muteAllMembers\n      });\n    }\n  },\n  methods: {\n    inputFocus: function inputFocus(ref) {\n      var _this = this;\n\n      this.$nextTick(function () {\n        _this.$refs[ref].focus();\n      });\n    },\n    editName: function editName() {\n      var _this2 = this;\n\n      this.tim.updateGroupProfile({\n        groupID: this.groupProfile.groupID,\n        name: this.name.trim()\n      }).then(function () {\n        _this2.showEditName = false;\n      }).catch(function (error) {\n        _this2.$store.commit('showMessage', {\n          type: 'error',\n          message: error.message\n        });\n      });\n    },\n    editFaceUrl: function editFaceUrl() {\n      var _this3 = this;\n\n      this.tim.updateGroupProfile({\n        groupID: this.groupProfile.groupID,\n        avatar: this.avatar.trim()\n      }).then(function () {\n        _this3.showEditFaceUrl = false;\n      }).catch(function (error) {\n        _this3.$store.commit('showMessage', {\n          type: 'error',\n          message: error.message\n        });\n      });\n    },\n    changeMuteStatus: function changeMuteStatus() {\n      var _this4 = this;\n\n      if (this.isOwner || this.isAdmin) {\n        this.tim.updateGroupProfile({\n          muteAllMembers: this.muteAllMembers,\n          groupID: this.groupProfile.groupID\n        }).then(function (imResponse) {\n          _this4.muteAllMembers = imResponse.data.group.muteAllMembers;\n\n          if (_this4.muteAllMembers) {\n            _this4.active = true;\n\n            _this4.$store.commit('showMessage', {\n              message: '全体禁言'\n            });\n          } else {\n            _this4.active = false;\n\n            _this4.$store.commit('showMessage', {\n              message: '取消全体禁言'\n            });\n          }\n        }).catch(function (error) {\n          _this4.$store.commit('showMessage', {\n            type: 'error',\n            message: error.message\n          });\n        });\n      } else {\n        this.muteAllMembers = this.groupProfile.muteAllMembers;\n        this.$store.commit('showMessage', {\n          type: 'error',\n          message: '普通群成员不能对全体禁言'\n        });\n      }\n    },\n    editIntroduction: function editIntroduction() {\n      var _this5 = this;\n\n      this.tim.updateGroupProfile({\n        groupID: this.groupProfile.groupID,\n        introduction: this.introduction.trim()\n      }).then(function () {\n        _this5.showEditIntroduction = false;\n      }).catch(function (error) {\n        _this5.$store.commit('showMessage', {\n          type: 'error',\n          message: error.message\n        });\n      });\n    },\n    editNotification: function editNotification() {\n      var _this6 = this;\n\n      this.tim.updateGroupProfile({\n        groupID: this.groupProfile.groupID,\n        notification: this.notification.trim()\n      }).then(function () {\n        _this6.showEditNotification = false;\n      }).catch(function (error) {\n        _this6.$store.commit('showMessage', {\n          type: 'error',\n          message: error.message\n        });\n      });\n    },\n    editJoinOption: function editJoinOption() {\n      var _this7 = this;\n\n      this.tim.updateGroupProfile({\n        groupID: this.groupProfile.groupID,\n        joinOption: this.joinOption\n      }).then(function () {\n        _this7.showEditJoinOption = false;\n      }).catch(function (error) {\n        _this7.$store.commit('showMessage', {\n          type: 'error',\n          message: error.message\n        });\n      });\n    },\n    changeOwner: function changeOwner() {\n      var _this8 = this;\n\n      this.tim.changeGroupOwner({\n        groupID: this.groupProfile.groupID,\n        newOwnerID: this.newOwnerUserID\n      }).then(function () {\n        _this8.showChangeGroupOwner = false;\n\n        _this8.$store.commit('showMessage', {\n          message: \"\\u8F6C\\u8BA9\\u7FA4\\u4E3B\\u6210\\u529F\\uFF0C\\u65B0\\u7FA4\\u4E3BID\\uFF1A\".concat(_this8.newOwnerUserID)\n        });\n\n        _this8.newOwnerUserID = '';\n      }).catch(function (error) {\n        _this8.$store.commit('showMessage', {\n          type: 'error',\n          message: error.message\n        });\n      });\n    },\n    quitGroup: function quitGroup() {\n      var _this9 = this;\n\n      this.tim.quitGroup(this.groupProfile.groupID).then(function (_ref) {\n        var groupID = _ref.data.groupID;\n\n        _this9.$store.commit('showMessage', {\n          message: '退群成功'\n        });\n\n        if (groupID === _this9.groupProfile.groupID) {\n          _this9.$store.commit('resetCurrentConversation');\n        }\n      }).catch(function (error) {\n        _this9.$store.commit('showMessage', {\n          type: 'error',\n          message: error.message\n        });\n      });\n    },\n    dismissGroup: function dismissGroup() {\n      var _this10 = this;\n\n      this.tim.dismissGroup(this.groupProfile.groupID).then(function (_ref2) {\n        var groupID = _ref2.data.groupID;\n\n        _this10.$store.commit('showMessage', {\n          message: \"\\u7FA4\\uFF1A\".concat(_this10.groupProfile.name || _this10.groupProfile.groupID, \"\\u89E3\\u6563\\u6210\\u529F\\uFF01\"),\n          type: 'success'\n        });\n\n        if (groupID === _this10.groupProfile.groupID) {\n          _this10.$store.commit('resetCurrentConversation');\n        }\n      }).catch(function (error) {\n        _this10.$store.commit('showMessage', {\n          type: 'error',\n          message: error.message\n        });\n      });\n    },\n    editMessageRemindType: function editMessageRemindType() {\n      var _this11 = this;\n\n      this.tim.setMessageRemindType({\n        groupID: this.groupProfile.groupID,\n        messageRemindType: this.messageRemindType\n      }).then(function () {\n        _this11.showEditMessageRemindType = false;\n      }).catch(function (error) {\n        _this11.$store.commit('showMessage', {\n          type: 'error',\n          message: error.message\n        });\n      });\n    },\n    editNameCard: function editNameCard() {\n      var _this12 = this;\n\n      if (this.nameCard.trim().length === 0) {\n        this.$store.commit('showMessage', {\n          message: '不能设置空的群名片',\n          type: 'warning'\n        });\n        return;\n      }\n\n      this.tim.setGroupMemberNameCard({\n        groupID: this.groupProfile.groupID,\n        nameCard: this.nameCard.trim()\n      }).then(function () {\n        _this12.showEditNameCard = false;\n      }).catch(function (error) {\n        _this12.$store.commit('showMessage', {\n          type: 'error',\n          message: error.message\n        });\n      });\n    }\n  }\n};",{"version":3,"mappings":"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","names":["props","components","GroupMemberList","ElSelect","ElOption","ElSwitch","data","showEditName","showEditFaceUrl","showEditIntroduction","showEditNotification","showEditJoinOption","showChangeGroupOwner","showEditMessageRemindType","showEditNameCard","name","avatar","introduction","notification","joinOption","newOwnerUserID","messageRemindType","nameCard","muteAllMembers","messageRemindTypeMap","AcceptAndNotify","AcceptNotNotify","Discard","joinOptionMap","FreeAccess","NeedPermission","DisableApply","active","computed","editable","isOwner","isAdmin","showDissmissGroup","groupType","watch","groupProfile","Object","methods","inputFocus","ref","editName","updateGroupProfile","groupID","then","catch","type","message","editFaceUrl","changeMuteStatus","editIntroduction","editNotification","editJoinOption","changeOwner","changeGroupOwner","newOwnerID","quitGroup","dismissGroup","editMessageRemindType","setMessageRemindType","editNameCard","setGroupMemberNameCard"],"sourceRoot":"src/components/conversation/conversationProfile","sources":["group-profile.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <group-member-list :groupProfile=\"groupProfile\" />\r\n    <div class=\"group-info-content\">\r\n      <div class=\"info-item\">\r\n        <div class=\"label\">群ID</div>\r\n        <div class=\"content\">{{ groupProfile.groupID }}</div>\r\n      </div>\r\n      <div class=\"info-item\">\r\n        <div class=\"label\">\r\n          群头像\r\n          <i\r\n              class=\"el-icon-edit\"\r\n              v-if=\"editable\"\r\n              @click=\"\r\n            showEditFaceUrl = true\r\n            inputFocus('editFaceUrl')\r\n          \"\r\n              style=\"cursor:pointer; font-size:16px;\"\r\n          />\r\n        </div>\r\n        <div class=\"content\" v-if=\"!showEditFaceUrl\">\r\n          <avatar :src=\"groupProfile.avatar\"/>\r\n\r\n        </div>\r\n        <el-input\r\n            ref=\"editFaceUrl\"\r\n            v-else\r\n            autofocus\r\n            v-model=\"avatar\"\r\n            size=\"mini\"\r\n            @blur=\"showEditFaceUrl = false\"\r\n            @keydown.enter.native=\"editFaceUrl\"\r\n        />\r\n      </div>\r\n\r\n      <div class=\"info-item\">\r\n        <div class=\"label\">群类型</div>\r\n        <div class=\"content\">{{ groupType}}</div>\r\n      </div>\r\n      <div class=\"info-item\">\r\n        <div class=\"label\">\r\n          群名称\r\n          <i\r\n              class=\"el-icon-edit\"\r\n              v-if=\"editable\"\r\n              @click=\"\r\n            showEditName = true\r\n            inputFocus('editName')\r\n          \"\r\n              style=\"cursor:pointer; font-size:16px;\"\r\n          />\r\n        </div>\r\n\r\n        <div class=\"content text-ellipsis\" :title=\"groupProfile.name\" v-if=\"!showEditName\">\r\n          {{ groupProfile.name || '暂无' }}\r\n        </div>\r\n        <el-input\r\n            ref=\"editName\"\r\n            v-else\r\n            autofocus\r\n            v-model=\"name\"\r\n            size=\"mini\"\r\n            @blur=\"showEditName = false\"\r\n            @keydown.enter.native=\"editName\"\r\n        />\r\n      </div>\r\n      <div class=\"info-item\">\r\n        <div class=\"label\">\r\n          群介绍\r\n          <i\r\n              class=\"el-icon-edit\"\r\n              v-if=\"editable\"\r\n              @click=\"\r\n            showEditIntroduction = true\r\n            inputFocus('editIntroduction')\r\n          \"\r\n              style=\"cursor:pointer; font-size:16px;\"\r\n          />\r\n        </div>\r\n        <div class=\"long-content\" :title=\"groupProfile.introduction\" v-if=\"!showEditIntroduction\">\r\n          {{ groupProfile.introduction || '暂无' }}\r\n        </div>\r\n        <el-input\r\n            ref=\"editIntroduction\"\r\n            v-else\r\n            autofocus\r\n            v-model=\"introduction\"\r\n            size=\"mini\"\r\n            @blur=\"showEditIntroduction = false\"\r\n            @keydown.enter.native=\"editIntroduction\"\r\n        />\r\n      </div>\r\n      <div class=\"info-item\">\r\n        <div class=\"label\">\r\n          群公告\r\n          <i\r\n              class=\"el-icon-edit\"\r\n              v-if=\"editable\"\r\n              @click=\"\r\n            showEditNotification = true\r\n            inputFocus('editNotification')\r\n          \"\r\n              style=\"cursor:pointer; font-size:16px;\"\r\n          />\r\n        </div>\r\n        <div class=\"long-content\" :title=\"groupProfile.notification\" v-if=\"!showEditNotification\">\r\n          {{ groupProfile.notification || '暂无' }}\r\n        </div>\r\n\r\n        <el-input\r\n            ref=\"editNotification\"\r\n            v-else\r\n            autofocus\r\n            v-model=\"notification\"\r\n            size=\"mini\"\r\n            @blur=\"showEditNotification = false\"\r\n            @keydown.enter.native=\"editNotification\"\r\n        />\r\n      </div>\r\n      <div class=\"info-item\" v-if=\"groupProfile.type !== 'Private'\">\r\n        <div class=\"label\">\r\n          申请加群方式\r\n          <i\r\n              class=\"el-icon-edit\"\r\n              v-if=\"editable\"\r\n              @click=\"\r\n            showEditJoinOption = true\r\n            inputFocus('editJoinOption')\r\n          \"\r\n              style=\"cursor:pointer; font-size:16px;\"\r\n          />\r\n        </div>\r\n        <div class=\"content\" v-show=\"!showEditJoinOption\">\r\n          {{ joinOptionMap[groupProfile.joinOption] }}\r\n        </div>\r\n        <el-select\r\n            ref=\"editJoinOption\"\r\n            v-model=\"joinOption\"\r\n            v-show=\"showEditJoinOption\"\r\n            size=\"mini\"\r\n            automatic-dropdown\r\n            @blur=\"showEditJoinOption = false\"\r\n            @change=\"editJoinOption\"\r\n        >\r\n          <el-option label=\"自由加入\" value=\"FreeAccess\"></el-option>\r\n          <el-option label=\"需要验证\" value=\"NeedPermission\"></el-option>\r\n          <el-option label=\"禁止加群\" value=\"DisableApply\"></el-option>\r\n        </el-select>\r\n      </div>\r\n      <div class=\"info-item\">\r\n        <div class=\"label\">\r\n          群消息提示类型\r\n          <i\r\n              class=\"el-icon-edit\"\r\n              v-if=\"editable\"\r\n              @click=\"\r\n            showEditMessageRemindType = true\r\n            inputFocus('editMessageRemindType')\r\n          \"\r\n              style=\"cursor:pointer; font-size:16px;\"\r\n          />\r\n        </div>\r\n        <div class=\"content\" v-show=\"!showEditMessageRemindType\">\r\n          {{ messageRemindTypeMap[this.groupProfile.selfInfo.messageRemindType] }}\r\n        </div>\r\n        <el-select\r\n            ref=\"editMessageRemindType\"\r\n            v-show=\"showEditMessageRemindType\"\r\n            v-model=\"messageRemindType\"\r\n            size=\"mini\"\r\n            automatic-dropdown\r\n            @change=\"editMessageRemindType\"\r\n            @blur=\"showEditMessageRemindType = false\"\r\n        >\r\n          <el-option label=\"接收消息并提示\" value=\"AcceptAndNotify\"></el-option>\r\n          <el-option label=\"接收消息但不提示\" value=\"AcceptNotNotify\"></el-option>\r\n          <el-option label=\"屏蔽消息\" value=\"Discard\"></el-option>\r\n        </el-select>\r\n      </div>\r\n      <div class=\"info-item\">\r\n        <div class=\"label\">\r\n          我的群名片\r\n          <i\r\n            class=\"el-icon-edit\"\r\n            @click=\"\r\n              showEditNameCard = true\r\n              inputFocus('editNameCard')\r\n            \"\r\n            style=\"cursor:pointer; font-size:16px;\"\r\n          />\r\n        </div>\r\n        <div class=\"content cursor-pointer\" v-if=\"!showEditNameCard\">\r\n          {{ groupProfile.selfInfo.nameCard || '暂无' }}\r\n        </div>\r\n        <el-input\r\n          ref=\"editNameCard\"\r\n          v-else\r\n          autofocus\r\n          v-model=\"nameCard\"\r\n          size=\"mini\"\r\n          @blur=\"showEditNameCard = false\"\r\n          @keydown.enter.native=\"editNameCard\"\r\n        />\r\n      </div>\r\n      <div class=\"info-item\">\r\n        <div class=\"label\" :class=\"{'active' : active}\">全体禁言</div>\r\n        <el-switch\r\n                v-model=\"muteAllMembers\"\r\n                active-color=\"#409eff\"\r\n                inactive-color=\"#dcdfe6\"\r\n                @change='changeMuteStatus'>\r\n        </el-switch>\r\n      </div>\r\n      <div v-if=\"isOwner\">\r\n        <el-button type=\"text\" @click=\"showChangeGroupOwner = true\">转让群组</el-button>\r\n        <el-input\r\n            v-if=\"showChangeGroupOwner\"\r\n            v-model=\"newOwnerUserID\"\r\n            placeholder=\"新群主的userID\"\r\n            size=\"mini\"\r\n            @blur=\"showChangeGroupOwner = false\"\r\n            @keydown.enter.native=\"changeOwner\"\r\n        />\r\n      </div>\r\n      <div>\r\n        <el-button type=\"text\" style=\"color:red;\" @click=\"quitGroup\">退出群组</el-button>\r\n      </div>\r\n      <div v-if=\"showDissmissGroup\">\r\n        <el-button type=\"text\" style=\"color:red;\" @click=\"dismissGroup\">解散群组</el-button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport GroupMemberList from './group-member-list.vue'\r\nimport { Select, Option, Switch } from 'element-ui'\r\nexport default {\r\n  props: ['groupProfile'],\r\n  components: {\r\n    GroupMemberList,\r\n    ElSelect: Select,\r\n    ElOption: Option,\r\n    ElSwitch: Switch,\r\n  },\r\n  data() {\r\n    return {\r\n      showEditName: false,\r\n      showEditFaceUrl: false,\r\n      showEditIntroduction: false,\r\n      showEditNotification: false,\r\n      showEditJoinOption: false,\r\n      showChangeGroupOwner: false,\r\n      showEditMessageRemindType: false,\r\n      showEditNameCard: false,\r\n      name: this.groupProfile.name,\r\n      avatar: this.groupProfile.avatar,\r\n      introduction: this.groupProfile.introduction,\r\n      notification: this.groupProfile.notification,\r\n      joinOption: this.groupProfile.joinOption,\r\n      newOwnerUserID: '',\r\n      messageRemindType: this.groupProfile.selfInfo.messageRemindType,\r\n      nameCard: this.groupProfile.selfInfo.nameCard || '',\r\n      muteAllMembers: this.groupProfile.muteAllMembers,\r\n      messageRemindTypeMap: {\r\n        AcceptAndNotify: '接收消息并提示',\r\n        AcceptNotNotify: '接收消息但不提示',\r\n        Discard: '屏蔽消息'\r\n      },\r\n      joinOptionMap: {\r\n        FreeAccess: '自由加入',\r\n        NeedPermission: '需要验证',\r\n        DisableApply: '禁止加群'\r\n      },\r\n      active:false\r\n    }\r\n  },\r\n  computed: {\r\n    editable() {\r\n      return (\r\n        this.groupProfile.type === this.TIM.TYPES.GRP_WORK ||\r\n        [this.TIM.TYPES.GRP_MBR_ROLE_OWNER, this.TIM.TYPES.GRP_MBR_ROLE_ADMIN].includes(this.groupProfile.selfInfo.role)\r\n      )\r\n    },\r\n    isOwner() {\r\n      return this.groupProfile.selfInfo.role === this.TIM.TYPES.GRP_MBR_ROLE_OWNER\r\n    },\r\n    isAdmin() {\r\n      return this.groupProfile.selfInfo.role === this.TIM.TYPES.GRP_MBR_ROLE_ADMIN\r\n    },\r\n    showDissmissGroup() {\r\n      // 好友工作群不能解散\r\n      return this.isOwner && this.groupProfile.type !== this.TIM.TYPES.GRP_WORK\r\n    },\r\n    groupType() {\r\n      switch (this.groupProfile.type) {\r\n        case this.TIM.TYPES.GRP_WORK:\r\n          return '好友工作群（Work）'\r\n        case this.TIM.TYPES.GRP_PUBLIC:\r\n          return '陌生人社交群（Public）'\r\n        case this.TIM.TYPES.GRP_CHATROOM:\r\n          return '临时会议群（Meeting）'\r\n        case this.TIM.TYPES.GRP_AVCHATROOM:\r\n          return '直播群（AVChatRoom）'\r\n        default:\r\n          return ''\r\n      }\r\n    }\r\n  },\r\n  watch: {\r\n    groupProfile(groupProfile) {\r\n      Object.assign(this, {\r\n        showEditName: false,\r\n        showEditFaceUrl: false,\r\n        showEditIntroduction: false,\r\n        showEditNotification: false,\r\n        showEditJoinOption: false,\r\n        showChangeGroupOwner: false,\r\n        showEditNameCard: false,\r\n        name: groupProfile.name,\r\n        avatar: groupProfile.avatar,\r\n        introduction: groupProfile.introduction,\r\n        notification: groupProfile.notification,\r\n        joinOption: groupProfile.joinOption,\r\n        messageRemindType: groupProfile.messageRemindType,\r\n        nameCard: groupProfile.selfInfo.nameCard || '',\r\n        muteAllMembers: groupProfile.muteAllMembers,\r\n      })\r\n    }\r\n  },\r\n  methods: {\r\n    inputFocus(ref) {\r\n      this.$nextTick(() => {\r\n        this.$refs[ref].focus()\r\n      })\r\n    },\r\n    editName() {\r\n      this.tim\r\n        .updateGroupProfile({\r\n          groupID: this.groupProfile.groupID,\r\n          name: this.name.trim()\r\n        })\r\n        .then(() => {\r\n          this.showEditName = false\r\n        })\r\n        .catch(error => {\r\n          this.$store.commit('showMessage', {\r\n            type: 'error',\r\n            message: error.message\r\n          })\r\n        })\r\n    },\r\n    editFaceUrl() {\r\n      this.tim\r\n        .updateGroupProfile({\r\n          groupID: this.groupProfile.groupID,\r\n          avatar: this.avatar.trim()\r\n        })\r\n        .then(() => {\r\n          this.showEditFaceUrl = false\r\n        })\r\n        .catch(error => {\r\n          this.$store.commit('showMessage', {\r\n            type: 'error',\r\n            message: error.message\r\n          })\r\n        })\r\n    },\r\n    changeMuteStatus() {\r\n      if (this.isOwner || this.isAdmin) {\r\n        this.tim\r\n          .updateGroupProfile({\r\n          muteAllMembers: this.muteAllMembers,\r\n          groupID: this.groupProfile.groupID\r\n        })\r\n          .then(imResponse => {\r\n          this.muteAllMembers = imResponse.data.group.muteAllMembers\r\n          if (this.muteAllMembers) {\r\n            this.active = true\r\n            this.$store.commit('showMessage', {\r\n              message: '全体禁言'\r\n            })\r\n          } else {\r\n            this.active = false\r\n            this.$store.commit('showMessage', {\r\n              message: '取消全体禁言'\r\n            })\r\n          }\r\n        })\r\n          .catch(error => {\r\n          this.$store.commit('showMessage', {\r\n            type: 'error',\r\n            message: error.message\r\n          })\r\n        })\r\n      } else {\r\n        this.muteAllMembers = this.groupProfile.muteAllMembers\r\n        this.$store.commit('showMessage', {\r\n          type: 'error',\r\n          message: '普通群成员不能对全体禁言'\r\n        })\r\n      }\r\n    },\r\n    editIntroduction() {\r\n      this.tim\r\n        .updateGroupProfile({\r\n          groupID: this.groupProfile.groupID,\r\n          introduction: this.introduction.trim()\r\n        })\r\n        .then(() => {\r\n          this.showEditIntroduction = false\r\n        })\r\n        .catch(error => {\r\n          this.$store.commit('showMessage', {\r\n            type: 'error',\r\n            message: error.message\r\n          })\r\n        })\r\n    },\r\n    editNotification() {\r\n      this.tim\r\n        .updateGroupProfile({\r\n          groupID: this.groupProfile.groupID,\r\n          notification: this.notification.trim()\r\n        })\r\n        .then(() => {\r\n          this.showEditNotification = false\r\n        })\r\n        .catch(error => {\r\n          this.$store.commit('showMessage', {\r\n            type: 'error',\r\n            message: error.message\r\n          })\r\n        })\r\n    },\r\n    editJoinOption() {\r\n      this.tim\r\n        .updateGroupProfile({\r\n          groupID: this.groupProfile.groupID,\r\n          joinOption: this.joinOption\r\n        })\r\n        .then(() => {\r\n          this.showEditJoinOption = false\r\n        })\r\n        .catch(error => {\r\n          this.$store.commit('showMessage', {\r\n            type: 'error',\r\n            message: error.message\r\n          })\r\n        })\r\n    },\r\n    changeOwner() {\r\n      this.tim\r\n        .changeGroupOwner({\r\n          groupID: this.groupProfile.groupID,\r\n          newOwnerID: this.newOwnerUserID\r\n        })\r\n        .then(() => {\r\n          this.showChangeGroupOwner = false\r\n          this.$store.commit('showMessage', {\r\n            message: `转让群主成功，新群主ID：${this.newOwnerUserID}`\r\n          })\r\n          this.newOwnerUserID = ''\r\n        })\r\n        .catch(error => {\r\n          this.$store.commit('showMessage', {\r\n            type: 'error',\r\n            message: error.message\r\n          })\r\n        })\r\n    },\r\n    quitGroup() {\r\n      this.tim.quitGroup(this.groupProfile.groupID).then(({ data: { groupID } }) => {\r\n        this.$store.commit('showMessage', {\r\n          message: '退群成功'\r\n        })\r\n        if (groupID === this.groupProfile.groupID) {\r\n          this.$store.commit('resetCurrentConversation')\r\n        }\r\n      })\r\n      .catch(error => {\r\n          this.$store.commit('showMessage', {\r\n            type: 'error',\r\n            message: error.message\r\n          })\r\n        })\r\n    },\r\n    dismissGroup() {\r\n      this.tim.dismissGroup(this.groupProfile.groupID).then(({ data: { groupID } }) => {\r\n        this.$store.commit('showMessage', {\r\n          message: `群：${this.groupProfile.name || this.groupProfile.groupID}解散成功！`,\r\n          type: 'success'\r\n        })\r\n        if (groupID === this.groupProfile.groupID) {\r\n          this.$store.commit('resetCurrentConversation')\r\n        }\r\n      })\r\n      .catch(error => {\r\n          this.$store.commit('showMessage', {\r\n            type: 'error',\r\n            message: error.message\r\n          })\r\n        })\r\n    },\r\n    editMessageRemindType() {\r\n      this.tim\r\n        .setMessageRemindType({\r\n          groupID: this.groupProfile.groupID,\r\n          messageRemindType: this.messageRemindType\r\n        })\r\n        .then(() => {\r\n          this.showEditMessageRemindType = false\r\n        })\r\n        .catch(error => {\r\n          this.$store.commit('showMessage', {\r\n            type: 'error',\r\n            message: error.message\r\n          })\r\n        })\r\n    },\r\n    editNameCard() {\r\n      if (this.nameCard.trim().length === 0) {\r\n        this.$store.commit('showMessage', {\r\n          message: '不能设置空的群名片',\r\n          type: 'warning'\r\n        })\r\n        return\r\n      }\r\n      this.tim\r\n        .setGroupMemberNameCard({\r\n          groupID: this.groupProfile.groupID,\r\n          nameCard: this.nameCard.trim()\r\n        })\r\n        .then(() => {\r\n          this.showEditNameCard = false\r\n        })\r\n        .catch(error => {\r\n          this.$store.commit('showMessage', {\r\n            type: 'error',\r\n            message: error.message\r\n          })\r\n        })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"stylus\">\r\n.group-info-content\r\n  padding 10px 10px\r\n  .avatar\r\n    width 40px\r\n    height 40px\r\n    border-radius 50%\r\n.info-item {\r\n  margin-bottom: 12px;\r\n\r\n  .label {\r\n    font-size: 14px;\r\n    color: $secondary;\r\n  }\r\n  .active {\r\n    color: $black\r\n  }\r\n  .content {\r\n    color: $background;\r\n    word-wrap: break-word;\r\n    word-break: break-all;\r\n  }\r\n  .long-content {\r\n    word-wrap:break-word;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n    display: -webkit-box;\r\n    -webkit-box-orient: vertical;\r\n    -webkit-line-clamp: 3;\r\n  }\r\n}\r\n.cursor-pointer {\r\n  cursor: pointer;\r\n}\r\n/* 设置滚动条的样式 */\r\n::-webkit-scrollbar {\r\n  width: 0px;\r\n  height: 0px;\r\n}\r\n</style>\r\n"]}]}