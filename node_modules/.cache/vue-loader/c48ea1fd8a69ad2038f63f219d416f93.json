{"remainingRequest":"D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\project\\softwareDevelopment\\IM-Web\\src\\components\\conversation\\conversationProfile\\user-profile.vue?vue&type=style&index=0&id=809108c8&lang=stylus&scoped=true&","dependencies":[{"path":"D:\\project\\softwareDevelopment\\IM-Web\\src\\components\\conversation\\conversationProfile\\user-profile.vue","mtime":1649851412186},{"path":"D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\css-loader\\index.js","mtime":1649851454163},{"path":"D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1649851455885},{"path":"D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\postcss-loader\\src\\index.js","mtime":1649851455029},{"path":"D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\stylus-loader\\index.js","mtime":1649851453855},{"path":"D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1649851454799},{"path":"D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\vue-loader\\lib\\index.js","mtime":1649851455309}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\n.profile-user\r\n  width 100%\r\n  text-align center\r\n  padding 0 20px\r\n  .avatar\r\n    width 160px\r\n    height 160px\r\n    border-radius 50%\r\n    margin 30px auto\r\n  .nick-name\r\n    width 100%\r\n    color $base\r\n    font-size 20px\r\n    font-weight bold\r\n    text-shadow $font-dark 0 0 0.1em\r\n    .anonymous\r\n      color $first\r\n      text-shadow none\r\n  .gender\r\n    padding 5px 0 10px 0\r\n    border-bottom 1px solid $border-base\r\n  .btn-add-blacklist\r\n    color $danger\r\n  .el-select\r\n    margin-left -248px\r\n  .add-item\r\n    display flex\r\n    .avatar\r\n      display block\r\n      width 48px\r\n      height 48px\r\n      border-radius 50%\r\n      margin 0\r\n    .item-nick\r\n      line-height 48px\r\n      margin-left  20px\r\n\r\n\r\n\r\n",{"version":3,"sources":["user-profile.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"user-profile.vue","sourceRoot":"src/components/conversation/conversationProfile","sourcesContent":["<template>\r\n  <div class=\"profile-user\">\r\n    <avatar :title=userProfile.userID :src=\"userProfile.avatar\" />\r\n    <div class=\"nick-name text-ellipsis\">\r\n      <span v-if=\"userProfile.nick\" :title=userProfile.nick>\r\n        {{ userProfile.nick }}\r\n      </span>\r\n      <span v-else class=\"anonymous\" title=\"该用户未设置昵称\">\r\n        [Anonymous]\r\n      </span>\r\n    </div>\r\n    <div class=\"gender\" v-if=\"genderClass\">\r\n      <span :title=\"gender\" class=\"iconfont\" :class=\"genderClass\"></span>\r\n    </div>\r\n    <el-button\r\n      title=\"将该用户加入黑名单\"\r\n      type=\"text\"\r\n      @click=\"addToBlackList\"\r\n      v-if=\"!isInBlacklist && userProfile.userID !== myUserID\"\r\n      class=\"btn-add-blacklist\"\r\n      >加入黑名单</el-button\r\n    >\r\n    <el-button title=\"将该用户移出黑名单\" type=\"text\" @click=\"removeFromBlacklist\" v-else-if=\"isInBlacklist\">移出黑名单</el-button>\r\n    <el-button title=\"删除好友\" type=\"text\" @click=\"removeFromFriendList\" v-if=\"isFriend\">删除好友</el-button>\r\n    <el-button\r\n          title=\"加好友\"\r\n          type=\"text\"\r\n          @click=\"dialogAddFriendVisible = true\"\r\n          v-if=\"!isFriend\"\r\n          class=\"btn-add-friend\"\r\n    >添加好友</el-button>\r\n    <el-dialog title=\"添加好友\" :visible.sync=\"dialogAddFriendVisible\" width=\"600px\">\r\n      <el-form :model=\"addInfo\">\r\n        <el-form-item label=\"\" :label-width=\"formLabelWidth\">\r\n          <div class=\"add-item\">\r\n            <img\r\n                    class=\"avatar\"\r\n                    :src=\"userProfile.avatar ? userProfile.avatar : 'http://imgcache.qq.com/open/qcloud/video/act/webim-avatar/avatar-2.png'\"\r\n            />\r\n            <div  class=\"item-nick\">{{userProfile.nick||userProfile.userID}}</div>\r\n          </div>\r\n        </el-form-item>\r\n        <el-form-item label=\"请输入验证信息\" :label-width=\"formLabelWidth\">\r\n          <el-input\r\n                  type=\"textarea\"\r\n                  :rows=\"2\"\r\n                  placeholder=\"请输入内容\"\r\n                  v-model=\"addInfo.wording\">\r\n          </el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"分组\" :label-width=\"formLabelWidth\">\r\n          <el-select v-model=\"addInfo.groupName\" placeholder=\"\">\r\n            <el-option label=\"选择分组\" value=\"\"></el-option>\r\n            <el-option  v-for=\"name in friendGroupNameList\" :key=\"name\" :label=\"name\" :value=\"name\"></el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item label=\"备注\" :label-width=\"formLabelWidth\">\r\n          <el-input v-model=\"addInfo.remark\" autocomplete=\"off\"></el-input>\r\n        </el-form-item>\r\n      </el-form>\r\n      <div slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"dialogAddFriendVisible = false\">取 消</el-button>\r\n        <el-button type=\"primary\" @click=\"addFriend\">确 定</el-button>\r\n      </div>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapState } from 'vuex'\r\nimport { Select, Option, Form ,FormItem, Input} from 'element-ui'\r\n\r\n// import FriendItem from './friend-item.vue'\r\nexport default {\r\n  props: {\r\n    userProfile: {\r\n      type: Object,\r\n      required: true\r\n    }\r\n  },\r\n  components: {\r\n    ElSelect: Select,\r\n    ElOption: Option,\r\n    ElForm: Form,\r\n    ElFormItem: FormItem,\r\n    ElInput: Input,\r\n  },\r\n  data() {\r\n    return {\r\n      addInfo: {\r\n        remark: '',\r\n        groupName: '',\r\n        wording: '',\r\n        type: this.TIM.TYPES.SNS_ADD_TYPE_BOTH,\r\n      },\r\n      formLabelWidth: '120px',\r\n      dialogAddFriendVisible: false,\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapState({\r\n      blacklist: state => state.blacklist.blacklist,\r\n      friendList: state => state.friend.friendList,\r\n      myUserID: state => state.user.currentUserProfile.userID,\r\n      friendGroupList: state => state.friend.friendGroupList\r\n    }),\r\n    isInBlacklist() {\r\n      return this.blacklist.findIndex(item => item.userID === this.userProfile.userID) >= 0\r\n    },\r\n    isFriend() {\r\n      return this.friendList.findIndex(item => item.userID === this.userProfile.userID) >= 0\r\n    },\r\n    friendGroupNameList() {\r\n      return this.friendGroupList.map((item) => {return item.name})\r\n    },\r\n    gender() {\r\n      switch (this.userProfile.gender) {\r\n        case this.TIM.TYPES.GENDER_MALE:\r\n          return '男'\r\n        case this.TIM.TYPES.GENDER_FEMALE:\r\n          return '女'\r\n        default:\r\n          return '未设置'\r\n      }\r\n    },\r\n    genderClass() {\r\n      switch (this.userProfile.gender) {\r\n        case this.TIM.TYPES.GENDER_MALE:\r\n          return 'icon-male'\r\n        case this.TIM.TYPES.GENDER_FEMALE:\r\n          return 'icon-female'\r\n        default:\r\n          return ''\r\n      }\r\n    }\r\n  },\r\n  created() {\r\n  },\r\n  methods: {\r\n    addToBlackList() {\r\n      this.tim\r\n        .addToBlacklist({ userIDList: [this.userProfile.userID] })\r\n        .then(() => {\r\n          this.$store.dispatch('getBlacklist')\r\n        })\r\n        .catch(imError => {\r\n          this.$store.commit('showMessage', {\r\n            message: imError.message,\r\n            type: 'error'\r\n          })\r\n        })\r\n    },\r\n    addFriend() {\r\n      this.tim.addFriend({\r\n        to: this.userProfile.userID,\r\n        remark: this.addInfo.remark,\r\n        groupName: this.addInfo.groupName,\r\n        wording: this.addInfo.wording,\r\n        source: 'AddSource_Type_Web',\r\n        type: this.addInfo.type\r\n      }).then((res) => {\r\n          // console.log(res)\r\n        if (res.data.code === 30539) {\r\n          this.$store.commit('showMessage', {\r\n            message: res.data.message,\r\n            type: 'warning'\r\n          })\r\n        }\r\n      })\r\n        .catch(error => {\r\n          this.$store.commit('showMessage', {\r\n            message: error.message,\r\n            type: 'warning'\r\n          })\r\n        })\r\n      this.dialogAddFriendVisible = false\r\n      this.addInfo = {\r\n        remark: '',\r\n        groupName: '',\r\n        wording: '',\r\n      }\r\n    },\r\n    removeFromFriendList() {\r\n      let options = {\r\n        userIDList: [this.userProfile.userID],\r\n        type: this.TIM.TYPES.SNS_DELETE_TYPE_BOTH\r\n      }\r\n      this.tim.deleteFriend(options).then(() => {\r\n      }).catch(error => {\r\n        this.$store.commit('showMessage', {\r\n          type: 'error',\r\n          message: error.message\r\n        })\r\n      })\r\n    },\r\n    removeFromBlacklist() {\r\n      this.tim.removeFromBlacklist({ userIDList: [this.userProfile.userID] }).then(() => {\r\n        this.$store.commit('removeFromBlacklist', this.userProfile.userID)\r\n      })\r\n      .catch(error => {\r\n          this.$store.commit('showMessage', {\r\n            type: 'error',\r\n            message: error.message\r\n          })\r\n        })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"stylus\" scoped>\r\n.profile-user\r\n  width 100%\r\n  text-align center\r\n  padding 0 20px\r\n  .avatar\r\n    width 160px\r\n    height 160px\r\n    border-radius 50%\r\n    margin 30px auto\r\n  .nick-name\r\n    width 100%\r\n    color $base\r\n    font-size 20px\r\n    font-weight bold\r\n    text-shadow $font-dark 0 0 0.1em\r\n    .anonymous\r\n      color $first\r\n      text-shadow none\r\n  .gender\r\n    padding 5px 0 10px 0\r\n    border-bottom 1px solid $border-base\r\n  .btn-add-blacklist\r\n    color $danger\r\n  .el-select\r\n    margin-left -248px\r\n  .add-item\r\n    display flex\r\n    .avatar\r\n      display block\r\n      width 48px\r\n      height 48px\r\n      border-radius 50%\r\n      margin 0\r\n    .item-nick\r\n      line-height 48px\r\n      margin-left  20px\r\n\r\n\r\n\r\n</style>\r\n"]}]}