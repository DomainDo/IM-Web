{"remainingRequest":"D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\project\\softwareDevelopment\\IM-Web\\src\\components\\group\\create-group.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\project\\softwareDevelopment\\IM-Web\\src\\components\\group\\create-group.vue","mtime":1649851412190},{"path":"D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1649851454799},{"path":"D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\babel-loader\\lib\\index.js","mtime":1649851455045},{"path":"D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1649851454799},{"path":"D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\vue-loader\\lib\\index.js","mtime":1649851455309}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport {\r\n  Form,\r\n  FormItem,\r\n  Input,\r\n  Select,\r\n  Option,\r\n  Radio,\r\n  RadioGroup\r\n} from 'element-ui'\r\nexport default {\r\n  components: {\r\n    ElForm: Form,\r\n    ElFormItem: FormItem,\r\n    ElInput: Input,\r\n    ElSelect: Select,\r\n    ElOption: Option,\r\n    ElRadioGroup: RadioGroup,\r\n    ElRadio: Radio\r\n  },\r\n  data() {\r\n    return {\r\n      form: {\r\n        groupID: '',\r\n        name: '',\r\n        type: this.TIM.TYPES.GRP_WORK,\r\n        avatar: '',\r\n        introduction: '',\r\n        notification: '',\r\n        joinOption: 'FreeAccess',\r\n        memberList: []\r\n      },\r\n      options: [],\r\n      loading: false,\r\n      rules: {\r\n        name: [{ required: true, message: '请输入群名称', trigger: 'blur' }]\r\n      }\r\n    }\r\n  },\r\n  computed: {\r\n    joinOptionDisabled() {\r\n      return [\r\n        this.TIM.TYPES.GRP_WORK,\r\n        this.TIM.TYPES.GRP_MEETING,\r\n        this.TIM.TYPES.GRP_AVCHATROOM\r\n      ].includes(this.form.type)\r\n    }\r\n  },\r\n  methods: {\r\n    onSubmit(ref) {\r\n      this.$refs[ref].validate(valid => {\r\n        if (!valid) {\r\n          return false\r\n        }\r\n        this.createGroup()\r\n      })\r\n    },\r\n    closeCreateGroupModel() {\r\n      this.$store.commit('updateCreateGroupModelVisible', false)\r\n    },\r\n    createGroup() {\r\n      this.tim.createGroup(this.getOptions()).then((imResponse) => {\r\n         this.$store.commit('showMessage', {\r\n            message: `群组：【${imResponse.data.group.name}】创建成功`,\r\n            type: 'success'\r\n          })\r\n        this.closeCreateGroupModel()\r\n      })\r\n      .catch(error => {\r\n          this.$store.commit('showMessage', {\r\n            type: 'error',\r\n            message: error.message\r\n          })\r\n        })\r\n    },\r\n    getOptions() {\r\n      let options = {\r\n        ...this.form,\r\n        memberList: this.form.memberList.map(userID => ({ userID }))\r\n      }\r\n      if ([this.TIM.TYPES.GRP_WORK, this.TIM.TYPES.GRP_AVCHATROOM].includes(this.form.type)) {\r\n        delete options.joinOption\r\n      }\r\n      return options\r\n    },\r\n    handleSearchUser(userID) {\r\n      if (userID !== '') {\r\n        this.loading = true\r\n        this.tim.getUserProfile({ userIDList: [userID] }).then(({ data }) => {\r\n          this.options = data.map(item => item.userID)\r\n          this.loading = false\r\n        })\r\n        .catch(error => {\r\n          this.$store.commit('showMessage', {\r\n            type: 'error',\r\n            message: error.message\r\n          })\r\n        })\r\n      }\r\n    }\r\n  }\r\n}\r\n",{"version":3,"sources":["create-group.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"create-group.vue","sourceRoot":"src/components/group","sourcesContent":["<template>\r\n  <div>\r\n    <el-form :model=\"form\" :rules=\"rules\" ref=\"createGroupForm\" label-width=\"100px\">\r\n      <el-form-item label=\"群ID\">\r\n        <el-input v-model=\"form.groupID\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"群名称\" prop=\"name\">\r\n        <el-input v-model=\"form.name\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"群类型\">\r\n        <el-select v-model=\"form.type\">\r\n          <el-option label=\"Work\" :value=\"TIM.TYPES.GRP_WORK\"></el-option>\r\n          <el-option label=\"Public\" :value=\"TIM.TYPES.GRP_PUBLIC\"></el-option>\r\n          <el-option label=\"Meeting\" :value=\"TIM.TYPES.GRP_MEETING\"></el-option>\r\n          <el-option label=\"AVChatRoom\" :value=\"TIM.TYPES.GRP_AVCHATROOM\"></el-option>\r\n        </el-select>\r\n      </el-form-item>\r\n      <el-form-item label=\"群头像地址\">\r\n        <el-input v-model=\"form.avatar\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"群简介\">\r\n        <el-input type=\"textarea\" v-model=\"form.introduction\" :maxlength=\"240\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"群公告\">\r\n        <el-input type=\"textarea\" v-model=\"form.notification\" :maxlength=\"300\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"加群方式\">\r\n        <el-radio-group v-model=\"form.joinOption\" :disabled=\"joinOptionDisabled\">\r\n          <el-radio label=\"FreeAccess\">自由加群</el-radio>\r\n          <el-radio label=\"NeedPermission\">需要验证</el-radio>\r\n          <el-radio label=\"DisableApply\">禁止加群</el-radio>\r\n        </el-radio-group>\r\n      </el-form-item>\r\n      <el-form-item label=\"群成员列表\">\r\n        <el-select\r\n          v-model=\"form.memberList\"\r\n          default-first-option\r\n          multiple\r\n          filterable\r\n          remote\r\n          :disabled=\"form.type === TIM.TYPES.GRP_AVCHATROOM\"\r\n          :remote-method=\"handleSearchUser\"\r\n          :loading=\"loading\"\r\n          placeholder=\"请输入群成员 userID\"\r\n        >\r\n          <el-option v-for=\"item in options\" :key=\"item\" :label=\"item\" :value=\"item\"></el-option>\r\n        </el-select>\r\n      </el-form-item>\r\n    </el-form>\r\n    <div slot=\"footer\">\r\n      <el-button type=\"primary\" @click=\"onSubmit('createGroupForm')\">立即创建</el-button>\r\n      <el-button @click=\"closeCreateGroupModel\">取消</el-button>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {\r\n  Form,\r\n  FormItem,\r\n  Input,\r\n  Select,\r\n  Option,\r\n  Radio,\r\n  RadioGroup\r\n} from 'element-ui'\r\nexport default {\r\n  components: {\r\n    ElForm: Form,\r\n    ElFormItem: FormItem,\r\n    ElInput: Input,\r\n    ElSelect: Select,\r\n    ElOption: Option,\r\n    ElRadioGroup: RadioGroup,\r\n    ElRadio: Radio\r\n  },\r\n  data() {\r\n    return {\r\n      form: {\r\n        groupID: '',\r\n        name: '',\r\n        type: this.TIM.TYPES.GRP_WORK,\r\n        avatar: '',\r\n        introduction: '',\r\n        notification: '',\r\n        joinOption: 'FreeAccess',\r\n        memberList: []\r\n      },\r\n      options: [],\r\n      loading: false,\r\n      rules: {\r\n        name: [{ required: true, message: '请输入群名称', trigger: 'blur' }]\r\n      }\r\n    }\r\n  },\r\n  computed: {\r\n    joinOptionDisabled() {\r\n      return [\r\n        this.TIM.TYPES.GRP_WORK,\r\n        this.TIM.TYPES.GRP_MEETING,\r\n        this.TIM.TYPES.GRP_AVCHATROOM\r\n      ].includes(this.form.type)\r\n    }\r\n  },\r\n  methods: {\r\n    onSubmit(ref) {\r\n      this.$refs[ref].validate(valid => {\r\n        if (!valid) {\r\n          return false\r\n        }\r\n        this.createGroup()\r\n      })\r\n    },\r\n    closeCreateGroupModel() {\r\n      this.$store.commit('updateCreateGroupModelVisible', false)\r\n    },\r\n    createGroup() {\r\n      this.tim.createGroup(this.getOptions()).then((imResponse) => {\r\n         this.$store.commit('showMessage', {\r\n            message: `群组：【${imResponse.data.group.name}】创建成功`,\r\n            type: 'success'\r\n          })\r\n        this.closeCreateGroupModel()\r\n      })\r\n      .catch(error => {\r\n          this.$store.commit('showMessage', {\r\n            type: 'error',\r\n            message: error.message\r\n          })\r\n        })\r\n    },\r\n    getOptions() {\r\n      let options = {\r\n        ...this.form,\r\n        memberList: this.form.memberList.map(userID => ({ userID }))\r\n      }\r\n      if ([this.TIM.TYPES.GRP_WORK, this.TIM.TYPES.GRP_AVCHATROOM].includes(this.form.type)) {\r\n        delete options.joinOption\r\n      }\r\n      return options\r\n    },\r\n    handleSearchUser(userID) {\r\n      if (userID !== '') {\r\n        this.loading = true\r\n        this.tim.getUserProfile({ userIDList: [userID] }).then(({ data }) => {\r\n          this.options = data.map(item => item.userID)\r\n          this.loading = false\r\n        })\r\n        .catch(error => {\r\n          this.$store.commit('showMessage', {\r\n            type: 'error',\r\n            message: error.message\r\n          })\r\n        })\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"stylus\" scoped>\r\n</style>\r\n"]}]}