{"remainingRequest":"D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\project\\softwareDevelopment\\IM-Web\\src\\components\\message\\merger-message\\message-merger.vue?vue&type=style&index=0&id=8d87855a&lang=stylus&scoped=true&","dependencies":[{"path":"D:\\project\\softwareDevelopment\\IM-Web\\src\\components\\message\\merger-message\\message-merger.vue","mtime":1649851412191},{"path":"D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\css-loader\\index.js","mtime":1649851454163},{"path":"D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1649851455885},{"path":"D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\postcss-loader\\src\\index.js","mtime":1649851455029},{"path":"D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\stylus-loader\\index.js","mtime":1649851453855},{"path":"D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1649851454799},{"path":"D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\vue-loader\\lib\\index.js","mtime":1649851455309}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/* 当前会话的骨架屏 */\n.merger-conversation-wrapper\n    height 54vh\n    /*background-color #ffffff*/\n    color $base\n    display flex\n    .current-conversation\n        display: flex;\n        flex-direction: column;\n        width: 100%;\n        height: 100%;\n.content\n    display: flex;\n    flex 1\n    flex-direction: column;\n    height: 100%;\n    overflow: hidden;\n    position: relative;\n    .message-list\n        width: 100%;\n        box-sizing: border-box;\n        overflow-y: scroll;\n        padding: 0 20px;\n\n.footer\n    border-top: 1px solid $border-base;\n.show-more {\n    text-align: right;\n    padding: 10px 20px 0 0;\n}\n/deep/ .el-checkbox {\n    width 100%\n}\n/deep/ .el-checkbox__label {\n    width 100%\n    padding-right 20px\n    box-sizing border-box\n}\n/deep/ .el-divider--horizontal {\n    display: block;\n    height: 1px;\n    width: 90%;\n    margin: 0 auto 8px;\n}\n.message-item {\n    display flex\n    /*border-bottom 1px solid #DEDEDE*/\n    /*padding-bottom  10px*/\n}\n.avatar-box {\n    .avatar {\n        width: 36px;\n        height: 36px;\n        border-radius: 50%;\n        box-shadow: 0 5px 10px 0 rgba(0, 0, 0, 0.1);\n    }\n}\n.container-box {\n    display flex\n    flex-direction column\n    .nick-date {\n        font-size 12px\n        color #B3B3B3\n        display flex\n        flex-direction row\n        .name {\n            margin 0 5px\n        }\n    }\n\n}\n",{"version":3,"sources":["message-merger.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA","file":"message-merger.vue","sourceRoot":"src/components/message/merger-message","sourcesContent":["<template>\r\n    <div class=\"merger-conversation-wrapper\">\r\n        <div class=\"current-conversation\" @scroll=\"onScroll\">\r\n            <div class=\"content\">\r\n                <div class=\"message-list\" ref=\"message-list\" @scroll=\"this.onScroll\">\r\n                    <div   v-for=\"(messageItem, index) in mergerList(mergerMessage)\" :key=\"index\">\r\n                        <div class=\"message-item\">\r\n                            <div class=\"avatar-box\">\r\n                                <avatar class=\"group-member-avatar\" :src=\"messageItem.avatar\"/>\r\n                            </div>\r\n                            <div class=\"container-box\">\r\n                                <div class=\"nick-date\">\r\n                                    <div class=\"name text-ellipsis\">{{messageItem.nick || messageItem.from || '小晨曦'}}</div>\r\n                                    <div class=\"date\">{{ getDate(messageItem.time) }}</div>\r\n                                </div>\r\n                                <merger-message-item v-for=\"(item,index) in messageItem.messageBody\" :key=\"index\" :message=\"item\" :payload=\"item.payload\"/>\r\n                            </div>\r\n                        </div>\r\n                        <el-divider></el-divider>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n  import {  mapState } from 'vuex'\r\n  import MergerMessageItem from './mergerMessage-item'\r\n  import { getFullDate } from '../../../utils/date'\r\n  export default {\r\n    name: 'CurrentConversation',\r\n    components: {\r\n      MergerMessageItem,\r\n    },\r\n    data() {\r\n      return {\r\n        preScrollHeight: 0,\r\n        mergerMessageList: [],\r\n        showMessage: null,\r\n\r\n      }\r\n    },\r\n    computed: {\r\n      ...mapState({\r\n        currentConversation: state => state.conversation.currentConversation,\r\n        mergerMessage: state => state.conversation.mergerMessage\r\n      }),\r\n      mergerList() {\r\n        return function(message) {\r\n          return message.payload.messageList\r\n        }\r\n      }\r\n    },\r\n    created () {\r\n    },\r\n    mounted() {\r\n\r\n    },\r\n    updated() {\r\n\r\n    },\r\n    watch: {\r\n\r\n    },\r\n    methods: {\r\n      getDate(time) {\r\n        return getFullDate(new Date(time * 1000))\r\n      },\r\n      onScroll({ target: { scrollTop } }) {\r\n        let messageListNode = this.$refs['message-list']\r\n        if (!messageListNode) {\r\n          return\r\n        }\r\n        if (this.preScrollHeight - messageListNode.clientHeight - scrollTop < 20) {\r\n          this.isShowScrollButtomTips = false\r\n        }\r\n      },\r\n      // 如果滚到底部就保持在底部，否则提示是否要滚到底部\r\n      keepMessageListOnButtom() {\r\n        let messageListNode = this.$refs['message-list']\r\n        if (!messageListNode) {\r\n          return\r\n        }\r\n        // 距离底部20px内强制滚到底部,否则提示有新消息\r\n        if (this.preScrollHeight - messageListNode.clientHeight - messageListNode.scrollTop < 20) {\r\n          this.$nextTick(() => {\r\n            messageListNode.scrollTop = messageListNode.scrollHeight\r\n          })\r\n          this.isShowScrollButtomTips = false\r\n        } else {\r\n          this.isShowScrollButtomTips = true\r\n        }\r\n        this.preScrollHeight = messageListNode.scrollHeight\r\n      },\r\n      // 直接滚到底部\r\n      scrollMessageListToButtom() {\r\n        this.$nextTick(() => {\r\n          let messageListNode = this.$refs['message-list']\r\n          if (!messageListNode) {\r\n            return\r\n          }\r\n          messageListNode.scrollTop = messageListNode.scrollHeight\r\n          this.preScrollHeight = messageListNode.scrollHeight\r\n          this.isShowScrollButtomTips = false\r\n        })\r\n      },\r\n      onImageLoaded() {\r\n        this.keepMessageListOnButtom()\r\n      }\r\n    }\r\n  }\r\n</script>\r\n\r\n<style lang=\"stylus\" scoped>\r\n    /* 当前会话的骨架屏 */\r\n    .merger-conversation-wrapper\r\n        height 54vh\r\n        /*background-color #ffffff*/\r\n        color $base\r\n        display flex\r\n        .current-conversation\r\n            display: flex;\r\n            flex-direction: column;\r\n            width: 100%;\r\n            height: 100%;\r\n    .content\r\n        display: flex;\r\n        flex 1\r\n        flex-direction: column;\r\n        height: 100%;\r\n        overflow: hidden;\r\n        position: relative;\r\n        .message-list\r\n            width: 100%;\r\n            box-sizing: border-box;\r\n            overflow-y: scroll;\r\n            padding: 0 20px;\r\n\r\n    .footer\r\n        border-top: 1px solid $border-base;\r\n    .show-more {\r\n        text-align: right;\r\n        padding: 10px 20px 0 0;\r\n    }\r\n    /deep/ .el-checkbox {\r\n        width 100%\r\n    }\r\n    /deep/ .el-checkbox__label {\r\n        width 100%\r\n        padding-right 20px\r\n        box-sizing border-box\r\n    }\r\n    /deep/ .el-divider--horizontal {\r\n        display: block;\r\n        height: 1px;\r\n        width: 90%;\r\n        margin: 0 auto 8px;\r\n    }\r\n    .message-item {\r\n        display flex\r\n        /*border-bottom 1px solid #DEDEDE*/\r\n        /*padding-bottom  10px*/\r\n    }\r\n    .avatar-box {\r\n        .avatar {\r\n            width: 36px;\r\n            height: 36px;\r\n            border-radius: 50%;\r\n            box-shadow: 0 5px 10px 0 rgba(0, 0, 0, 0.1);\r\n        }\r\n    }\r\n    .container-box {\r\n        display flex\r\n        flex-direction column\r\n        .nick-date {\r\n            font-size 12px\r\n            color #B3B3B3\r\n            display flex\r\n            flex-direction row\r\n            .name {\r\n                margin 0 5px\r\n            }\r\n        }\r\n\r\n    }\r\n</style>\r\n"]}]}