{"remainingRequest":"D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\project\\softwareDevelopment\\IM-Web\\src\\components\\friend\\friend-container.vue?vue&type=style&index=0&lang=stylus&scpoed=true&","dependencies":[{"path":"D:\\project\\softwareDevelopment\\IM-Web\\src\\components\\friend\\friend-container.vue","mtime":1649851412187},{"path":"D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\css-loader\\index.js","mtime":1649851454163},{"path":"D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1649851455885},{"path":"D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\postcss-loader\\src\\index.js","mtime":1649851455029},{"path":"D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\stylus-loader\\index.js","mtime":1649851453855},{"path":"D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1649851454799},{"path":"D:\\project\\softwareDevelopment\\IM-Web\\node_modules\\vue-loader\\lib\\index.js","mtime":1649851455309}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.friend-content {\n    /*width 60%*/\n    width 100%\n    .friend-box {\n        margin 100px auto 0\n        width 360px\n        .profile-container {\n            display flex\n            justify-content space-between\n            .item-nick {\n                width 200px\n                line-height 48px\n            }\n            .avatar {\n                display block\n                width 48px\n                height 48px\n                border-radius 50%\n                margin-right 25px\n            }\n        }\n        .el-input {\n            width 50%\n        }\n        .el-select .el-input {\n            width 100%\n        }\n        .content-box {\n            display flex\n            /*justify-content space-between*/\n            margin 18px 0\n            .text-content {\n                height 40px\n            }\n            .text-box {\n                display flex\n                justify-content center\n                align-items center\n            }\n            .content-title {\n                display inline-block\n                min-width 80px\n                font-size 16px\n                color #717175\n                margin-right 140px\n            }\n            .content-text {\n                font-size 18px\n                color #000000\n                word-break break-word\n            }\n            .content-width {\n                display inline-block\n                max-width 115px\n                height 28px\n            }\n            .edit-icon {\n                cursor: pointer\n                font-size 16px\n                margin-left 6px\n                margin-top 8px\n            }\n\n        }\n\n        .sendBtn {\n            cursor pointer\n            width 120px\n            height 40px\n            border-radius 5px\n            background-color #00A4FF\n            color #ffffff\n            font-size 16px\n            margin 80px auto 0\n            text-align center\n            line-height 40px\n        }\n\n        .delete-text {\n            position absolute\n            cursor pointer\n            left 0\n            right 0\n            margin auto\n            bottom 25px\n            width 120px\n            height 40px\n            font-size 17px\n            color #586B95\n            text-align center\n        }\n        .application-box {\n            display flex\n            justify-content space-between\n        }\n        .application-delete {\n            cursor pointer\n            width 120px\n            height 40px\n            border-radius 5px\n            border 1px solid #00A4FF\n            color #1c2438\n            font-size 16px\n            margin-top 80px\n            text-align center\n            line-height 40px\n        }\n        .application-refuse {\n            cursor pointer\n            width 120px\n            height 40px\n            border-radius 5px\n            background-color #00A4FF\n            border 1px solid #00A4FF\n            color #ffffff\n            font-size 16px\n            margin-top 80px\n            text-align center\n            line-height 40px\n        }\n    }\n}\n\n\n",{"version":3,"sources":["friend-container.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"friend-container.vue","sourceRoot":"src/components/friend","sourcesContent":["<template>\r\n    <div class=\"friend-content\" v-if=\"showFriendContent || showApplicationContent\" @click=\"closeHandler\">\r\n        <div class=\"friend-box\" v-if=\"showFriendContent\">\r\n            <div class=\"profile-container\" >\r\n                <div class=\"item-nick text-ellipsis\">{{friendProfile.profile.nick||friendProfile.profile.userID}}</div>\r\n                <img\r\n                        class=\"avatar\"\r\n                        :src=\"friendProfile.profile.avatar ? friendProfile.profile.avatar : 'https://imgcache.qq.com/open/qcloud/video/act/webim-avatar/avatar-2.png'\"\r\n                />\r\n            </div>\r\n            <el-divider></el-divider>\r\n            <p class=\"content-box\"><span class=\"content-title\">userID</span><span class=\"content-text\">{{friendProfile.userID}}</span></p>\r\n            <div class=\"content-box\"><span class=\"content-title\">备注名</span>\r\n                <div class=\"text-box\"   v-if=\"!showEditRemark\">\r\n                    <span class=\"content-text  content-width text-ellipsis\">{{friendProfile.remark || '暂无'}}</span>\r\n                    <i\r\n                            class=\"el-icon-edit\"\r\n                            @click.stop=\"\r\n                        showEditRemark = true\r\n                        inputFocus('showEditRemark')\r\n\r\n            \"\r\n                            style=\"cursor:pointer; font-size:16px; margin-left: 6px\"\r\n                    />\r\n                </div>\r\n                <el-input\r\n                        style=\"display: inline-block\"\r\n                        ref=\"showEditRemark\"\r\n                        v-else\r\n                        autofocus\r\n                        v-model=\"profileRemark\"\r\n                        size=\"mini\"\r\n                        @blur=\"blurHandler\"\r\n                        @keydown.enter.native=\"editRemarkHandler\"\r\n                />\r\n            </div>\r\n\r\n            <p class=\"content-box\"><span class=\"content-title\">来源</span><span class=\"content-text\">{{getSource(friendProfile.source)}}</span></p>\r\n            <el-divider></el-divider>\r\n            <div class=\"content-box\" v-show=\"friendType==='friendList'\">\r\n                <span class=\"content-title\" v-show=\"!showEdit\" style=\"line-height: 35px\">所在分组</span>\r\n                <span class=\"content-title\" v-show=\"showEdit\"  style=\"line-height: 35px\">添加到分组</span>\r\n                <div class=\"text-content\">\r\n                    <span class=\"content-text\" v-show=\"!showEdit\">{{groupName}}</span>\r\n                    <i class=\"el-icon-edit edit-icon\" v-show=\"!showEdit\"   @click.stop=\"showEditHandler\"></i>\r\n                </div>\r\n                <el-select v-if=\"showEdit\" v-model=\"addGroupName\"  placeholder=\"选择分组\" @change=\"addToFriendGroup\">\r\n                    <el-option\r\n                            v-for=\"item in friendGroupList\"\r\n                            @blur=\"showEdit = false\"\r\n                            :key=\"item.name\"\r\n                            :label=\"item.name\"\r\n                            :value=\"item.name\">\r\n                    </el-option>\r\n                </el-select>\r\n            </div>\r\n            <p class=\"content-box\" v-show=\"friendType==='groupFriend'\" style=\"height: 40px\">\r\n                <span class=\"content-title\" style=\"line-height: 35px\">所在分组</span>\r\n                <span class=\"content-text\" v-show=\"!showEdit\" style=\"line-height: 35px\">{{groupName}}</span>\r\n            </p>\r\n            <div class=\"sendBtn\" @click.stop=\"checkoutConversation(friendProfile.userID)\">发送消息</div>\r\n            <div class=\"delete-text\" v-show=\"friendType==='groupFriend'\" @click.stop=\"removeFromFriendGroup(friendProfile.userID)\">从该群组中移除</div>\r\n            <div class=\"delete-text\" v-show=\"friendType==='friendList'\" @click.stop=\"removeFromFriendList(friendProfile.userID)\">删除该好友</div>\r\n        </div>\r\n        <div class=\"friend-box\" v-if=\"showApplicationContent\">\r\n            <div class=\"profile-container\" >\r\n                <div class=\"item-nick text-ellipsis\">{{applicationContent.nick||applicationContent.userID}}</div>\r\n                <img\r\n                        class=\"avatar\"\r\n                        :src=\"applicationContent.avatar ? applicationContent.avatar : 'http://imgcache.qq.com/open/qcloud/video/act/webim-avatar/avatar-2.png'\"\r\n                />\r\n            </div>\r\n            <el-divider></el-divider>\r\n            <p class=\"content-box\"><span class=\"content-title\">userID</span><span class=\"content-text\">{{applicationContent.userID}}</span></p>\r\n            <p class=\"content-box\"><span class=\"content-title\">来源</span><span class=\"content-text content-width text-ellipsis\">{{getSource(applicationContent.source)}}</span></p>\r\n            <div class=\"content-box\" v-if=\"showRemark\"><span class=\"content-title\">备注名</span>\r\n                <el-input\r\n                        style=\"display: inline-block\"\r\n                        ref=\"showRemark\"\r\n                        autofocus\r\n                        v-model=\"acceptApplication.remark\"\r\n                        size=\"mini\"\r\n                        @blur=\"remarkBlurHandler\"\r\n                        @keydown.enter.native=\"editRemarkHandler\"\r\n                />\r\n            </div>\r\n            <el-divider></el-divider>\r\n            <p class=\"content-box\">\r\n                <span class=\"content-title\">打招呼</span>\r\n                <el-tooltip class=\"item\" effect=\"dark\" :content=\"applicationContent.wording\" placement=\"bottom-end\">\r\n                    <span class=\"content-text content-width text-ellipsis\">{{applicationContent.wording}}</span>\r\n                </el-tooltip>\r\n            </p>\r\n            <div class=\"application-box\" v-if=\"!showRemark\">\r\n                <p class=\"application-refuse\" @click=\"acceptHandler\">同意</p>\r\n                <p class=\"application-delete\"  @click=\"refuseFriendApplication(applicationContent.userID)\">拒绝</p>\r\n            </div>\r\n            <div class=\"application-box\" v-else>\r\n                <p class=\"application-refuse\" @click=\"acceptFriendApplication(applicationContent.userID)\">确认</p>\r\n                <p class=\"application-delete\"  @click=\"cancelHandler()\">取消</p>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n  import { mapState } from 'vuex'\r\n  export default {\r\n    name: 'index',\r\n    data() {\r\n      return {\r\n        showEdit: false,\r\n        showEditRemark: false,\r\n        showRemark: false,\r\n        addGroupName: '',\r\n        profileRemark: '',\r\n        editGroupList: [],\r\n        isUpdate: false,\r\n        acceptApplication: {\r\n          remark: '',\r\n          type: 'Response_Action_AgreeAndAdd',\r\n        },\r\n      }\r\n    },\r\n    computed: {\r\n      ...mapState({\r\n        friendContent: state => state.friend.friendContent,\r\n        applicationContent: state => state.friend.applicationContent,\r\n        friendGroupList: state => state.friend.friendGroupList,\r\n      }),\r\n      showFriendContent() {\r\n        if (JSON.stringify(this.friendContent) === '{}') {\r\n          return false\r\n        }\r\n        return true\r\n      },\r\n      showApplicationContent() {\r\n        if (JSON.stringify(this.applicationContent) === '{}') {\r\n          return false\r\n        }\r\n        return true\r\n      },\r\n      friendProfile() {\r\n        return this.friendContent.friend\r\n      },\r\n      groupName() {\r\n        if(this.friendProfile.groupList.length>0) {\r\n          return this.friendProfile.groupList.join(',')\r\n        }else {\r\n          return '暂无分组'\r\n        }\r\n      },\r\n      groupList:{\r\n        get() {\r\n          return this.friendProfile.groupList\r\n        },\r\n        set(value) {\r\n          this.editGroupList = value\r\n        }\r\n      },\r\n      friendType() {\r\n        return this.friendContent.type\r\n      },\r\n      getSource() {\r\n        return function (source) {\r\n          return source.substring(15)\r\n        }\r\n      },\r\n    },\r\n    methods: {\r\n      showEditHandler() {\r\n        this.showEdit = true\r\n        this.addGroupName = ''\r\n      },\r\n      inputFocus(ref) {\r\n        this.profileRemark = this.friendProfile.remark\r\n        this.$nextTick(() => {\r\n          this.$refs[ref].focus()\r\n        })\r\n      },\r\n      blurHandler() {\r\n        this.showEditRemark = false\r\n        this.isUpdate = true\r\n      },\r\n      remarkBlurHandler() {\r\n        // this.showEditRemark = false\r\n      },\r\n      acceptHandler() {\r\n        this.showRemark = true\r\n        this.acceptApplication.remark = ''\r\n        this.$nextTick(() => {\r\n          this.$refs.showRemark.focus()\r\n        })\r\n      },\r\n      cancelHandler() {\r\n        this.showRemark = false\r\n      },\r\n      closeHandler() {\r\n        this.showEdit = false\r\n        if (this.isUpdate) {\r\n          this.editRemarkHandler()\r\n        }\r\n      },\r\n      editRemarkHandler() {\r\n        this.showEditRemark = false\r\n        // 更新好友备注\r\n        this.tim.updateFriend({\r\n          userID: this.friendProfile.userID,\r\n          remark: this.profileRemark\r\n        }).then(()=> {\r\n        }).catch((imError)=> {\r\n          console.warn('getFriendProfile error:', imError) // 更新失败\r\n        })\r\n        this.isUpdate = false\r\n      },\r\n      updateFriendGroup() {\r\n        this.profileRemark = this.friendProfile.remark\r\n        // 更新好友分组\r\n        this.tim.updateFriend({\r\n          userID: this.friendProfile.userID,\r\n          groupList: this.editGroupList\r\n        }).then(()=>{\r\n        }).catch((imError)=> {\r\n          console.warn('getFriendProfile error:', imError) // 更新失败\r\n        })\r\n      },\r\n      checkoutConversation(userID) {\r\n        this.$store\r\n          .dispatch('checkoutConversation', `C2C${userID}`)\r\n          .then(() => {\r\n            this.showDialog = false\r\n            this.$bus.$emit('checkoutConversation')\r\n          }).catch(() => {\r\n          this.$store.commit('showMessage', {\r\n            message: '没有找到该用户',\r\n            type: 'warning'\r\n          })\r\n        })\r\n      },\r\n      addToFriendGroup() {\r\n        this.tim.addToFriendGroup({name: this.addGroupName, userIDList: [this.friendProfile.userID]}).then(() => {\r\n          this.$store.commit('showMessage', {\r\n            message: '添加成功',\r\n            type: 'success'\r\n          })\r\n        }).catch((error) => {\r\n          this.$store.commit('showMessage', {\r\n            type: 'error',\r\n            message: error.message\r\n          })\r\n        })\r\n        this.showEdit = false\r\n      },\r\n      removeFromFriendGroup(userID) {\r\n        this.tim.removeFromFriendGroup({\r\n          name: this.friendContent.groupName,\r\n          userIDList: [userID],\r\n        }).then(() => {\r\n          this.resetContent() // 清空页面\r\n        }).catch(() => {\r\n        })\r\n      },\r\n      removeFromFriendList(userID) {\r\n        this.tim.deleteFriend({\r\n          userIDList: [userID],\r\n          type: 'Delete_Type_Both'\r\n        }).then(() => {\r\n          this.resetContent() // 清空页面\r\n        }).catch(error => {\r\n          this.$store.commit('showMessage', {\r\n            type: 'error',\r\n            message: error.message\r\n          })\r\n        })\r\n      },\r\n      // 同意\r\n      acceptFriendApplication(userID) {\r\n        this.tim.acceptFriendApplication({\r\n          userID: userID,\r\n          remark: this.acceptApplication.remark,\r\n          tag: this.acceptApplication.tag,\r\n          type: this.acceptApplication.type\r\n        }).then(() => {\r\n          this.resetContent()\r\n          this.$store.commit('showMessage', {\r\n            message: '已同意加好友',\r\n            type: 'success'\r\n          })\r\n\r\n        }).catch((error) => {\r\n          this.$store.commit('showMessage', {\r\n            type: 'error',\r\n            message: error.message\r\n          })\r\n        })\r\n        this.acceptApplication.remark = ''\r\n        this.showRemark = false\r\n      },\r\n      // application\r\n      deleteFriendApplication(application) {\r\n        this.$store.commit('updateUnreadCount', 0)\r\n        this.tim.deleteFriendApplication({userID: application.userID ,type: application.type}).then(() => {\r\n          this.resetContent() // 清空页面\r\n          this.$store.commit('showMessage', {\r\n            message: '已删除',\r\n            type: 'success'\r\n          })\r\n        }).catch((error) => {\r\n          this.$store.commit('showMessage', {\r\n            type: 'error',\r\n            message: error.message\r\n          })\r\n        })\r\n      },\r\n      // 拒绝\r\n      refuseFriendApplication(userID) {\r\n        this.$store.commit('updateUnreadCount', 0)\r\n        this.tim.refuseFriendApplication({\r\n          userID: userID\r\n        }).then(() => {\r\n          this.resetContent() // 清空页面\r\n          this.$store.commit('showMessage', {\r\n            message: '已拒绝',\r\n            type: 'success'\r\n          }).catch((error) => {\r\n            this.$store.commit('showMessage', {\r\n              type: 'error',\r\n              message: error.message\r\n            })\r\n          })\r\n        })\r\n      },\r\n      resetContent() {\r\n        this.$store.commit('resetCurrentConversation')\r\n        this.$store.commit('resetFriendContent')\r\n        this.$store.commit('resetApplicationContent')\r\n      }\r\n    }\r\n  }\r\n</script>\r\n\r\n<style lang=\"stylus\" scpoed>\r\n    .friend-content {\r\n        /*width 60%*/\r\n        width 100%\r\n        .friend-box {\r\n            margin 100px auto 0\r\n            width 360px\r\n            .profile-container {\r\n                display flex\r\n                justify-content space-between\r\n                .item-nick {\r\n                    width 200px\r\n                    line-height 48px\r\n                }\r\n                .avatar {\r\n                    display block\r\n                    width 48px\r\n                    height 48px\r\n                    border-radius 50%\r\n                    margin-right 25px\r\n                }\r\n            }\r\n            .el-input {\r\n                width 50%\r\n            }\r\n            .el-select .el-input {\r\n                width 100%\r\n            }\r\n            .content-box {\r\n                display flex\r\n                /*justify-content space-between*/\r\n                margin 18px 0\r\n                .text-content {\r\n                    height 40px\r\n                }\r\n                .text-box {\r\n                    display flex\r\n                    justify-content center\r\n                    align-items center\r\n                }\r\n                .content-title {\r\n                    display inline-block\r\n                    min-width 80px\r\n                    font-size 16px\r\n                    color #717175\r\n                    margin-right 140px\r\n                }\r\n                .content-text {\r\n                    font-size 18px\r\n                    color #000000\r\n                    word-break break-word\r\n                }\r\n                .content-width {\r\n                    display inline-block\r\n                    max-width 115px\r\n                    height 28px\r\n                }\r\n                .edit-icon {\r\n                    cursor: pointer\r\n                    font-size 16px\r\n                    margin-left 6px\r\n                    margin-top 8px\r\n                }\r\n\r\n            }\r\n\r\n            .sendBtn {\r\n                cursor pointer\r\n                width 120px\r\n                height 40px\r\n                border-radius 5px\r\n                background-color #00A4FF\r\n                color #ffffff\r\n                font-size 16px\r\n                margin 80px auto 0\r\n                text-align center\r\n                line-height 40px\r\n            }\r\n\r\n            .delete-text {\r\n                position absolute\r\n                cursor pointer\r\n                left 0\r\n                right 0\r\n                margin auto\r\n                bottom 25px\r\n                width 120px\r\n                height 40px\r\n                font-size 17px\r\n                color #586B95\r\n                text-align center\r\n            }\r\n            .application-box {\r\n                display flex\r\n                justify-content space-between\r\n            }\r\n            .application-delete {\r\n                cursor pointer\r\n                width 120px\r\n                height 40px\r\n                border-radius 5px\r\n                border 1px solid #00A4FF\r\n                color #1c2438\r\n                font-size 16px\r\n                margin-top 80px\r\n                text-align center\r\n                line-height 40px\r\n            }\r\n            .application-refuse {\r\n                cursor pointer\r\n                width 120px\r\n                height 40px\r\n                border-radius 5px\r\n                background-color #00A4FF\r\n                border 1px solid #00A4FF\r\n                color #ffffff\r\n                font-size 16px\r\n                margin-top 80px\r\n                text-align center\r\n                line-height 40px\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n</style>\r\n"]}]}